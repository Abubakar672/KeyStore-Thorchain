{"ast":null,"code":"var bigInt = function (undefined) {\n  \"use strict\";\n\n  var BASE = 1e7,\n      LOG_BASE = 7,\n      MAX_INT = 9007199254740992,\n      MAX_INT_ARR = smallToArray(MAX_INT),\n      LOG_MAX_INT = Math.log(MAX_INT);\n\n  function Integer(v, radix) {\n    if (typeof v === \"undefined\") return Integer[0];\n    if (typeof radix !== \"undefined\") return +radix === 10 ? parseValue(v) : parseBase(v, radix);\n    return parseValue(v);\n  }\n\n  function BigInteger(value, sign) {\n    this.value = value;\n    this.sign = sign;\n    this.isSmall = false;\n  }\n\n  BigInteger.prototype = Object.create(Integer.prototype);\n\n  function SmallInteger(value) {\n    this.value = value;\n    this.sign = value < 0;\n    this.isSmall = true;\n  }\n\n  SmallInteger.prototype = Object.create(Integer.prototype);\n\n  function isPrecise(n) {\n    return -MAX_INT < n && n < MAX_INT;\n  }\n\n  function smallToArray(n) {\n    // For performance reasons doesn't reference BASE, need to change this function if BASE changes\n    if (n < 1e7) return [n];\n    if (n < 1e14) return [n % 1e7, Math.floor(n / 1e7)];\n    return [n % 1e7, Math.floor(n / 1e7) % 1e7, Math.floor(n / 1e14)];\n  }\n\n  function arrayToSmall(arr) {\n    // If BASE changes this function may need to change\n    trim(arr);\n    var length = arr.length;\n\n    if (length < 4 && compareAbs(arr, MAX_INT_ARR) < 0) {\n      switch (length) {\n        case 0:\n          return 0;\n\n        case 1:\n          return arr[0];\n\n        case 2:\n          return arr[0] + arr[1] * BASE;\n\n        default:\n          return arr[0] + (arr[1] + arr[2] * BASE) * BASE;\n      }\n    }\n\n    return arr;\n  }\n\n  function trim(v) {\n    var i = v.length;\n\n    while (v[--i] === 0);\n\n    v.length = i + 1;\n  }\n\n  function createArray(length) {\n    // function shamelessly stolen from Yaffle's library https://github.com/Yaffle/BigInteger\n    var x = new Array(length);\n    var i = -1;\n\n    while (++i < length) {\n      x[i] = 0;\n    }\n\n    return x;\n  }\n\n  function truncate(n) {\n    if (n > 0) return Math.floor(n);\n    return Math.ceil(n);\n  }\n\n  function add(a, b) {\n    // assumes a and b are arrays with a.length >= b.length\n    var l_a = a.length,\n        l_b = b.length,\n        r = new Array(l_a),\n        carry = 0,\n        base = BASE,\n        sum,\n        i;\n\n    for (i = 0; i < l_b; i++) {\n      sum = a[i] + b[i] + carry;\n      carry = sum >= base ? 1 : 0;\n      r[i] = sum - carry * base;\n    }\n\n    while (i < l_a) {\n      sum = a[i] + carry;\n      carry = sum === base ? 1 : 0;\n      r[i++] = sum - carry * base;\n    }\n\n    if (carry > 0) r.push(carry);\n    return r;\n  }\n\n  function addAny(a, b) {\n    if (a.length >= b.length) return add(a, b);\n    return add(b, a);\n  }\n\n  function addSmall(a, carry) {\n    // assumes a is array, carry is number with 0 <= carry < MAX_INT\n    var l = a.length,\n        r = new Array(l),\n        base = BASE,\n        sum,\n        i;\n\n    for (i = 0; i < l; i++) {\n      sum = a[i] - base + carry;\n      carry = Math.floor(sum / base);\n      r[i] = sum - carry * base;\n      carry += 1;\n    }\n\n    while (carry > 0) {\n      r[i++] = carry % base;\n      carry = Math.floor(carry / base);\n    }\n\n    return r;\n  }\n\n  BigInteger.prototype.add = function (v) {\n    var n = parseValue(v);\n\n    if (this.sign !== n.sign) {\n      return this.subtract(n.negate());\n    }\n\n    var a = this.value,\n        b = n.value;\n\n    if (n.isSmall) {\n      return new BigInteger(addSmall(a, Math.abs(b)), this.sign);\n    }\n\n    return new BigInteger(addAny(a, b), this.sign);\n  };\n\n  BigInteger.prototype.plus = BigInteger.prototype.add;\n\n  SmallInteger.prototype.add = function (v) {\n    var n = parseValue(v);\n    var a = this.value;\n\n    if (a < 0 !== n.sign) {\n      return this.subtract(n.negate());\n    }\n\n    var b = n.value;\n\n    if (n.isSmall) {\n      if (isPrecise(a + b)) return new SmallInteger(a + b);\n      b = smallToArray(Math.abs(b));\n    }\n\n    return new BigInteger(addSmall(b, Math.abs(a)), a < 0);\n  };\n\n  SmallInteger.prototype.plus = SmallInteger.prototype.add;\n\n  function subtract(a, b) {\n    // assumes a and b are arrays with a >= b\n    var a_l = a.length,\n        b_l = b.length,\n        r = new Array(a_l),\n        borrow = 0,\n        base = BASE,\n        i,\n        difference;\n\n    for (i = 0; i < b_l; i++) {\n      difference = a[i] - borrow - b[i];\n\n      if (difference < 0) {\n        difference += base;\n        borrow = 1;\n      } else borrow = 0;\n\n      r[i] = difference;\n    }\n\n    for (i = b_l; i < a_l; i++) {\n      difference = a[i] - borrow;\n      if (difference < 0) difference += base;else {\n        r[i++] = difference;\n        break;\n      }\n      r[i] = difference;\n    }\n\n    for (; i < a_l; i++) {\n      r[i] = a[i];\n    }\n\n    trim(r);\n    return r;\n  }\n\n  function subtractAny(a, b, sign) {\n    var value;\n\n    if (compareAbs(a, b) >= 0) {\n      value = subtract(a, b);\n    } else {\n      value = subtract(b, a);\n      sign = !sign;\n    }\n\n    value = arrayToSmall(value);\n\n    if (typeof value === \"number\") {\n      if (sign) value = -value;\n      return new SmallInteger(value);\n    }\n\n    return new BigInteger(value, sign);\n  }\n\n  function subtractSmall(a, b, sign) {\n    // assumes a is array, b is number with 0 <= b < MAX_INT\n    var l = a.length,\n        r = new Array(l),\n        carry = -b,\n        base = BASE,\n        i,\n        difference;\n\n    for (i = 0; i < l; i++) {\n      difference = a[i] + carry;\n      carry = Math.floor(difference / base);\n      difference %= base;\n      r[i] = difference < 0 ? difference + base : difference;\n    }\n\n    r = arrayToSmall(r);\n\n    if (typeof r === \"number\") {\n      if (sign) r = -r;\n      return new SmallInteger(r);\n    }\n\n    return new BigInteger(r, sign);\n  }\n\n  BigInteger.prototype.subtract = function (v) {\n    var n = parseValue(v);\n\n    if (this.sign !== n.sign) {\n      return this.add(n.negate());\n    }\n\n    var a = this.value,\n        b = n.value;\n    if (n.isSmall) return subtractSmall(a, Math.abs(b), this.sign);\n    return subtractAny(a, b, this.sign);\n  };\n\n  BigInteger.prototype.minus = BigInteger.prototype.subtract;\n\n  SmallInteger.prototype.subtract = function (v) {\n    var n = parseValue(v);\n    var a = this.value;\n\n    if (a < 0 !== n.sign) {\n      return this.add(n.negate());\n    }\n\n    var b = n.value;\n\n    if (n.isSmall) {\n      return new SmallInteger(a - b);\n    }\n\n    return subtractSmall(b, Math.abs(a), a >= 0);\n  };\n\n  SmallInteger.prototype.minus = SmallInteger.prototype.subtract;\n\n  BigInteger.prototype.negate = function () {\n    return new BigInteger(this.value, !this.sign);\n  };\n\n  SmallInteger.prototype.negate = function () {\n    var sign = this.sign;\n    var small = new SmallInteger(-this.value);\n    small.sign = !sign;\n    return small;\n  };\n\n  BigInteger.prototype.abs = function () {\n    return new BigInteger(this.value, false);\n  };\n\n  SmallInteger.prototype.abs = function () {\n    return new SmallInteger(Math.abs(this.value));\n  };\n\n  function multiplyLong(a, b) {\n    var a_l = a.length,\n        b_l = b.length,\n        l = a_l + b_l,\n        r = createArray(l),\n        base = BASE,\n        product,\n        carry,\n        i,\n        a_i,\n        b_j;\n\n    for (i = 0; i < a_l; ++i) {\n      a_i = a[i];\n\n      for (var j = 0; j < b_l; ++j) {\n        b_j = b[j];\n        product = a_i * b_j + r[i + j];\n        carry = Math.floor(product / base);\n        r[i + j] = product - carry * base;\n        r[i + j + 1] += carry;\n      }\n    }\n\n    trim(r);\n    return r;\n  }\n\n  function multiplySmall(a, b) {\n    // assumes a is array, b is number with |b| < BASE\n    var l = a.length,\n        r = new Array(l),\n        base = BASE,\n        carry = 0,\n        product,\n        i;\n\n    for (i = 0; i < l; i++) {\n      product = a[i] * b + carry;\n      carry = Math.floor(product / base);\n      r[i] = product - carry * base;\n    }\n\n    while (carry > 0) {\n      r[i++] = carry % base;\n      carry = Math.floor(carry / base);\n    }\n\n    return r;\n  }\n\n  function shiftLeft(x, n) {\n    var r = [];\n\n    while (n-- > 0) r.push(0);\n\n    return r.concat(x);\n  }\n\n  function multiplyKaratsuba(x, y) {\n    var n = Math.max(x.length, y.length);\n    if (n <= 30) return multiplyLong(x, y);\n    n = Math.ceil(n / 2);\n    var b = x.slice(n),\n        a = x.slice(0, n),\n        d = y.slice(n),\n        c = y.slice(0, n);\n    var ac = multiplyKaratsuba(a, c),\n        bd = multiplyKaratsuba(b, d),\n        abcd = multiplyKaratsuba(addAny(a, b), addAny(c, d));\n    var product = addAny(addAny(ac, shiftLeft(subtract(subtract(abcd, ac), bd), n)), shiftLeft(bd, 2 * n));\n    trim(product);\n    return product;\n  } // The following function is derived from a surface fit of a graph plotting the performance difference\n  // between long multiplication and karatsuba multiplication versus the lengths of the two arrays.\n\n\n  function useKaratsuba(l1, l2) {\n    return -0.012 * l1 - 0.012 * l2 + 0.000015 * l1 * l2 > 0;\n  }\n\n  BigInteger.prototype.multiply = function (v) {\n    var n = parseValue(v),\n        a = this.value,\n        b = n.value,\n        sign = this.sign !== n.sign,\n        abs;\n\n    if (n.isSmall) {\n      if (b === 0) return Integer[0];\n      if (b === 1) return this;\n      if (b === -1) return this.negate();\n      abs = Math.abs(b);\n\n      if (abs < BASE) {\n        return new BigInteger(multiplySmall(a, abs), sign);\n      }\n\n      b = smallToArray(abs);\n    }\n\n    if (useKaratsuba(a.length, b.length)) // Karatsuba is only faster for certain array sizes\n      return new BigInteger(multiplyKaratsuba(a, b), sign);\n    return new BigInteger(multiplyLong(a, b), sign);\n  };\n\n  BigInteger.prototype.times = BigInteger.prototype.multiply;\n\n  function multiplySmallAndArray(a, b, sign) {\n    // a >= 0\n    if (a < BASE) {\n      return new BigInteger(multiplySmall(b, a), sign);\n    }\n\n    return new BigInteger(multiplyLong(b, smallToArray(a)), sign);\n  }\n\n  SmallInteger.prototype._multiplyBySmall = function (a) {\n    if (isPrecise(a.value * this.value)) {\n      return new SmallInteger(a.value * this.value);\n    }\n\n    return multiplySmallAndArray(Math.abs(a.value), smallToArray(Math.abs(this.value)), this.sign !== a.sign);\n  };\n\n  BigInteger.prototype._multiplyBySmall = function (a) {\n    if (a.value === 0) return Integer[0];\n    if (a.value === 1) return this;\n    if (a.value === -1) return this.negate();\n    return multiplySmallAndArray(Math.abs(a.value), this.value, this.sign !== a.sign);\n  };\n\n  SmallInteger.prototype.multiply = function (v) {\n    return parseValue(v)._multiplyBySmall(this);\n  };\n\n  SmallInteger.prototype.times = SmallInteger.prototype.multiply;\n\n  function square(a) {\n    //console.assert(2 * BASE * BASE < MAX_INT);\n    var l = a.length,\n        r = createArray(l + l),\n        base = BASE,\n        product,\n        carry,\n        i,\n        a_i,\n        a_j;\n\n    for (i = 0; i < l; i++) {\n      a_i = a[i];\n      carry = 0 - a_i * a_i;\n\n      for (var j = i; j < l; j++) {\n        a_j = a[j];\n        product = 2 * (a_i * a_j) + r[i + j] + carry;\n        carry = Math.floor(product / base);\n        r[i + j] = product - carry * base;\n      }\n\n      r[i + l] = carry;\n    }\n\n    trim(r);\n    return r;\n  }\n\n  BigInteger.prototype.square = function () {\n    return new BigInteger(square(this.value), false);\n  };\n\n  SmallInteger.prototype.square = function () {\n    var value = this.value * this.value;\n    if (isPrecise(value)) return new SmallInteger(value);\n    return new BigInteger(square(smallToArray(Math.abs(this.value))), false);\n  };\n\n  function divMod1(a, b) {\n    // Left over from previous version. Performs faster than divMod2 on smaller input sizes.\n    var a_l = a.length,\n        b_l = b.length,\n        base = BASE,\n        result = createArray(b.length),\n        divisorMostSignificantDigit = b[b_l - 1],\n        // normalization\n    lambda = Math.ceil(base / (2 * divisorMostSignificantDigit)),\n        remainder = multiplySmall(a, lambda),\n        divisor = multiplySmall(b, lambda),\n        quotientDigit,\n        shift,\n        carry,\n        borrow,\n        i,\n        l,\n        q;\n    if (remainder.length <= a_l) remainder.push(0);\n    divisor.push(0);\n    divisorMostSignificantDigit = divisor[b_l - 1];\n\n    for (shift = a_l - b_l; shift >= 0; shift--) {\n      quotientDigit = base - 1;\n\n      if (remainder[shift + b_l] !== divisorMostSignificantDigit) {\n        quotientDigit = Math.floor((remainder[shift + b_l] * base + remainder[shift + b_l - 1]) / divisorMostSignificantDigit);\n      } // quotientDigit <= base - 1\n\n\n      carry = 0;\n      borrow = 0;\n      l = divisor.length;\n\n      for (i = 0; i < l; i++) {\n        carry += quotientDigit * divisor[i];\n        q = Math.floor(carry / base);\n        borrow += remainder[shift + i] - (carry - q * base);\n        carry = q;\n\n        if (borrow < 0) {\n          remainder[shift + i] = borrow + base;\n          borrow = -1;\n        } else {\n          remainder[shift + i] = borrow;\n          borrow = 0;\n        }\n      }\n\n      while (borrow !== 0) {\n        quotientDigit -= 1;\n        carry = 0;\n\n        for (i = 0; i < l; i++) {\n          carry += remainder[shift + i] - base + divisor[i];\n\n          if (carry < 0) {\n            remainder[shift + i] = carry + base;\n            carry = 0;\n          } else {\n            remainder[shift + i] = carry;\n            carry = 1;\n          }\n        }\n\n        borrow += carry;\n      }\n\n      result[shift] = quotientDigit;\n    } // denormalization\n\n\n    remainder = divModSmall(remainder, lambda)[0];\n    return [arrayToSmall(result), arrayToSmall(remainder)];\n  }\n\n  function divMod2(a, b) {\n    // Implementation idea shamelessly stolen from Silent Matt's library http://silentmatt.com/biginteger/\n    // Performs faster than divMod1 on larger input sizes.\n    var a_l = a.length,\n        b_l = b.length,\n        result = [],\n        part = [],\n        base = BASE,\n        guess,\n        xlen,\n        highx,\n        highy,\n        check;\n\n    while (a_l) {\n      part.unshift(a[--a_l]);\n      trim(part);\n\n      if (compareAbs(part, b) < 0) {\n        result.push(0);\n        continue;\n      }\n\n      xlen = part.length;\n      highx = part[xlen - 1] * base + part[xlen - 2];\n      highy = b[b_l - 1] * base + b[b_l - 2];\n\n      if (xlen > b_l) {\n        highx = (highx + 1) * base;\n      }\n\n      guess = Math.ceil(highx / highy);\n\n      do {\n        check = multiplySmall(b, guess);\n        if (compareAbs(check, part) <= 0) break;\n        guess--;\n      } while (guess);\n\n      result.push(guess);\n      part = subtract(part, check);\n    }\n\n    result.reverse();\n    return [arrayToSmall(result), arrayToSmall(part)];\n  }\n\n  function divModSmall(value, lambda) {\n    var length = value.length,\n        quotient = createArray(length),\n        base = BASE,\n        i,\n        q,\n        remainder,\n        divisor;\n    remainder = 0;\n\n    for (i = length - 1; i >= 0; --i) {\n      divisor = remainder * base + value[i];\n      q = truncate(divisor / lambda);\n      remainder = divisor - q * lambda;\n      quotient[i] = q | 0;\n    }\n\n    return [quotient, remainder | 0];\n  }\n\n  function divModAny(self, v) {\n    var value,\n        n = parseValue(v);\n    var a = self.value,\n        b = n.value;\n    var quotient;\n    if (b === 0) throw new Error(\"Cannot divide by zero\");\n\n    if (self.isSmall) {\n      if (n.isSmall) {\n        return [new SmallInteger(truncate(a / b)), new SmallInteger(a % b)];\n      }\n\n      return [Integer[0], self];\n    }\n\n    if (n.isSmall) {\n      if (b === 1) return [self, Integer[0]];\n      if (b == -1) return [self.negate(), Integer[0]];\n      var abs = Math.abs(b);\n\n      if (abs < BASE) {\n        value = divModSmall(a, abs);\n        quotient = arrayToSmall(value[0]);\n        var remainder = value[1];\n        if (self.sign) remainder = -remainder;\n\n        if (typeof quotient === \"number\") {\n          if (self.sign !== n.sign) quotient = -quotient;\n          return [new SmallInteger(quotient), new SmallInteger(remainder)];\n        }\n\n        return [new BigInteger(quotient, self.sign !== n.sign), new SmallInteger(remainder)];\n      }\n\n      b = smallToArray(abs);\n    }\n\n    var comparison = compareAbs(a, b);\n    if (comparison === -1) return [Integer[0], self];\n    if (comparison === 0) return [Integer[self.sign === n.sign ? 1 : -1], Integer[0]]; // divMod1 is faster on smaller input sizes\n\n    if (a.length + b.length <= 200) value = divMod1(a, b);else value = divMod2(a, b);\n    quotient = value[0];\n    var qSign = self.sign !== n.sign,\n        mod = value[1],\n        mSign = self.sign;\n\n    if (typeof quotient === \"number\") {\n      if (qSign) quotient = -quotient;\n      quotient = new SmallInteger(quotient);\n    } else quotient = new BigInteger(quotient, qSign);\n\n    if (typeof mod === \"number\") {\n      if (mSign) mod = -mod;\n      mod = new SmallInteger(mod);\n    } else mod = new BigInteger(mod, mSign);\n\n    return [quotient, mod];\n  }\n\n  BigInteger.prototype.divmod = function (v) {\n    var result = divModAny(this, v);\n    return {\n      quotient: result[0],\n      remainder: result[1]\n    };\n  };\n\n  SmallInteger.prototype.divmod = BigInteger.prototype.divmod;\n\n  BigInteger.prototype.divide = function (v) {\n    return divModAny(this, v)[0];\n  };\n\n  SmallInteger.prototype.over = SmallInteger.prototype.divide = BigInteger.prototype.over = BigInteger.prototype.divide;\n\n  BigInteger.prototype.mod = function (v) {\n    return divModAny(this, v)[1];\n  };\n\n  SmallInteger.prototype.remainder = SmallInteger.prototype.mod = BigInteger.prototype.remainder = BigInteger.prototype.mod;\n\n  BigInteger.prototype.pow = function (v) {\n    var n = parseValue(v),\n        a = this.value,\n        b = n.value,\n        value,\n        x,\n        y;\n    if (b === 0) return Integer[1];\n    if (a === 0) return Integer[0];\n    if (a === 1) return Integer[1];\n    if (a === -1) return n.isEven() ? Integer[1] : Integer[-1];\n\n    if (n.sign) {\n      return Integer[0];\n    }\n\n    if (!n.isSmall) throw new Error(\"The exponent \" + n.toString() + \" is too large.\");\n\n    if (this.isSmall) {\n      if (isPrecise(value = Math.pow(a, b))) return new SmallInteger(truncate(value));\n    }\n\n    x = this;\n    y = Integer[1];\n\n    while (true) {\n      if (b & 1 === 1) {\n        y = y.times(x);\n        --b;\n      }\n\n      if (b === 0) break;\n      b /= 2;\n      x = x.square();\n    }\n\n    return y;\n  };\n\n  SmallInteger.prototype.pow = BigInteger.prototype.pow;\n\n  BigInteger.prototype.modPow = function (exp, mod) {\n    exp = parseValue(exp);\n    mod = parseValue(mod);\n    if (mod.isZero()) throw new Error(\"Cannot take modPow with modulus 0\");\n    var r = Integer[1],\n        base = this.mod(mod);\n\n    while (exp.isPositive()) {\n      if (base.isZero()) return Integer[0];\n      if (exp.isOdd()) r = r.multiply(base).mod(mod);\n      exp = exp.divide(2);\n      base = base.square().mod(mod);\n    }\n\n    return r;\n  };\n\n  SmallInteger.prototype.modPow = BigInteger.prototype.modPow;\n\n  function compareAbs(a, b) {\n    if (a.length !== b.length) {\n      return a.length > b.length ? 1 : -1;\n    }\n\n    for (var i = a.length - 1; i >= 0; i--) {\n      if (a[i] !== b[i]) return a[i] > b[i] ? 1 : -1;\n    }\n\n    return 0;\n  }\n\n  BigInteger.prototype.compareAbs = function (v) {\n    var n = parseValue(v),\n        a = this.value,\n        b = n.value;\n    if (n.isSmall) return 1;\n    return compareAbs(a, b);\n  };\n\n  SmallInteger.prototype.compareAbs = function (v) {\n    var n = parseValue(v),\n        a = Math.abs(this.value),\n        b = n.value;\n\n    if (n.isSmall) {\n      b = Math.abs(b);\n      return a === b ? 0 : a > b ? 1 : -1;\n    }\n\n    return -1;\n  };\n\n  BigInteger.prototype.compare = function (v) {\n    // See discussion about comparison with Infinity:\n    // https://github.com/peterolson/BigInteger.js/issues/61\n    if (v === Infinity) {\n      return -1;\n    }\n\n    if (v === -Infinity) {\n      return 1;\n    }\n\n    var n = parseValue(v),\n        a = this.value,\n        b = n.value;\n\n    if (this.sign !== n.sign) {\n      return n.sign ? 1 : -1;\n    }\n\n    if (n.isSmall) {\n      return this.sign ? -1 : 1;\n    }\n\n    return compareAbs(a, b) * (this.sign ? -1 : 1);\n  };\n\n  BigInteger.prototype.compareTo = BigInteger.prototype.compare;\n\n  SmallInteger.prototype.compare = function (v) {\n    if (v === Infinity) {\n      return -1;\n    }\n\n    if (v === -Infinity) {\n      return 1;\n    }\n\n    var n = parseValue(v),\n        a = this.value,\n        b = n.value;\n\n    if (n.isSmall) {\n      return a == b ? 0 : a > b ? 1 : -1;\n    }\n\n    if (a < 0 !== n.sign) {\n      return a < 0 ? -1 : 1;\n    }\n\n    return a < 0 ? 1 : -1;\n  };\n\n  SmallInteger.prototype.compareTo = SmallInteger.prototype.compare;\n\n  BigInteger.prototype.equals = function (v) {\n    return this.compare(v) === 0;\n  };\n\n  SmallInteger.prototype.eq = SmallInteger.prototype.equals = BigInteger.prototype.eq = BigInteger.prototype.equals;\n\n  BigInteger.prototype.notEquals = function (v) {\n    return this.compare(v) !== 0;\n  };\n\n  SmallInteger.prototype.neq = SmallInteger.prototype.notEquals = BigInteger.prototype.neq = BigInteger.prototype.notEquals;\n\n  BigInteger.prototype.greater = function (v) {\n    return this.compare(v) > 0;\n  };\n\n  SmallInteger.prototype.gt = SmallInteger.prototype.greater = BigInteger.prototype.gt = BigInteger.prototype.greater;\n\n  BigInteger.prototype.lesser = function (v) {\n    return this.compare(v) < 0;\n  };\n\n  SmallInteger.prototype.lt = SmallInteger.prototype.lesser = BigInteger.prototype.lt = BigInteger.prototype.lesser;\n\n  BigInteger.prototype.greaterOrEquals = function (v) {\n    return this.compare(v) >= 0;\n  };\n\n  SmallInteger.prototype.geq = SmallInteger.prototype.greaterOrEquals = BigInteger.prototype.geq = BigInteger.prototype.greaterOrEquals;\n\n  BigInteger.prototype.lesserOrEquals = function (v) {\n    return this.compare(v) <= 0;\n  };\n\n  SmallInteger.prototype.leq = SmallInteger.prototype.lesserOrEquals = BigInteger.prototype.leq = BigInteger.prototype.lesserOrEquals;\n\n  BigInteger.prototype.isEven = function () {\n    return (this.value[0] & 1) === 0;\n  };\n\n  SmallInteger.prototype.isEven = function () {\n    return (this.value & 1) === 0;\n  };\n\n  BigInteger.prototype.isOdd = function () {\n    return (this.value[0] & 1) === 1;\n  };\n\n  SmallInteger.prototype.isOdd = function () {\n    return (this.value & 1) === 1;\n  };\n\n  BigInteger.prototype.isPositive = function () {\n    return !this.sign;\n  };\n\n  SmallInteger.prototype.isPositive = function () {\n    return this.value > 0;\n  };\n\n  BigInteger.prototype.isNegative = function () {\n    return this.sign;\n  };\n\n  SmallInteger.prototype.isNegative = function () {\n    return this.value < 0;\n  };\n\n  BigInteger.prototype.isUnit = function () {\n    return false;\n  };\n\n  SmallInteger.prototype.isUnit = function () {\n    return Math.abs(this.value) === 1;\n  };\n\n  BigInteger.prototype.isZero = function () {\n    return false;\n  };\n\n  SmallInteger.prototype.isZero = function () {\n    return this.value === 0;\n  };\n\n  BigInteger.prototype.isDivisibleBy = function (v) {\n    var n = parseValue(v);\n    var value = n.value;\n    if (value === 0) return false;\n    if (value === 1) return true;\n    if (value === 2) return this.isEven();\n    return this.mod(n).equals(Integer[0]);\n  };\n\n  SmallInteger.prototype.isDivisibleBy = BigInteger.prototype.isDivisibleBy;\n\n  function isBasicPrime(v) {\n    var n = v.abs();\n    if (n.isUnit()) return false;\n    if (n.equals(2) || n.equals(3) || n.equals(5)) return true;\n    if (n.isEven() || n.isDivisibleBy(3) || n.isDivisibleBy(5)) return false;\n    if (n.lesser(49)) return true; // we don't know if it's prime: let the other functions figure it out\n  }\n\n  function millerRabinTest(n, a) {\n    var nPrev = n.prev(),\n        b = nPrev,\n        r = 0,\n        d,\n        t,\n        i,\n        x;\n\n    while (b.isEven()) b = b.divide(2), r++;\n\n    next: for (i = 0; i < a.length; i++) {\n      if (n.lesser(a[i])) continue;\n      x = bigInt(a[i]).modPow(b, n);\n      if (x.equals(Integer[1]) || x.equals(nPrev)) continue;\n\n      for (d = r - 1; d != 0; d--) {\n        x = x.square().mod(n);\n        if (x.isUnit()) return false;\n        if (x.equals(nPrev)) continue next;\n      }\n\n      return false;\n    }\n\n    return true;\n  } // Set \"strict\" to true to force GRH-supported lower bound of 2*log(N)^2\n\n\n  BigInteger.prototype.isPrime = function (strict) {\n    var isPrime = isBasicPrime(this);\n    if (isPrime !== undefined) return isPrime;\n    var n = this.abs();\n    var bits = n.bitLength();\n    if (bits <= 64) return millerRabinTest(n, [2, 325, 9375, 28178, 450775, 9780504, 1795265022]);\n    var logN = Math.log(2) * bits;\n    var t = Math.ceil(strict === true ? 2 * Math.pow(logN, 2) : logN);\n\n    for (var a = [], i = 0; i < t; i++) {\n      a.push(bigInt(i + 2));\n    }\n\n    return millerRabinTest(n, a);\n  };\n\n  SmallInteger.prototype.isPrime = BigInteger.prototype.isPrime;\n\n  BigInteger.prototype.isProbablePrime = function (iterations) {\n    var isPrime = isBasicPrime(this);\n    if (isPrime !== undefined) return isPrime;\n    var n = this.abs();\n    var t = iterations === undefined ? 5 : iterations;\n\n    for (var a = [], i = 0; i < t; i++) {\n      a.push(bigInt.randBetween(2, n.minus(2)));\n    }\n\n    return millerRabinTest(n, a);\n  };\n\n  SmallInteger.prototype.isProbablePrime = BigInteger.prototype.isProbablePrime;\n\n  BigInteger.prototype.modInv = function (n) {\n    var t = bigInt.zero,\n        newT = bigInt.one,\n        r = parseValue(n),\n        newR = this.abs(),\n        q,\n        lastT,\n        lastR;\n\n    while (!newR.equals(bigInt.zero)) {\n      q = r.divide(newR);\n      lastT = t;\n      lastR = r;\n      t = newT;\n      r = newR;\n      newT = lastT.subtract(q.multiply(newT));\n      newR = lastR.subtract(q.multiply(newR));\n    }\n\n    if (!r.equals(1)) throw new Error(this.toString() + \" and \" + n.toString() + \" are not co-prime\");\n\n    if (t.compare(0) === -1) {\n      t = t.add(n);\n    }\n\n    if (this.isNegative()) {\n      return t.negate();\n    }\n\n    return t;\n  };\n\n  SmallInteger.prototype.modInv = BigInteger.prototype.modInv;\n\n  BigInteger.prototype.next = function () {\n    var value = this.value;\n\n    if (this.sign) {\n      return subtractSmall(value, 1, this.sign);\n    }\n\n    return new BigInteger(addSmall(value, 1), this.sign);\n  };\n\n  SmallInteger.prototype.next = function () {\n    var value = this.value;\n    if (value + 1 < MAX_INT) return new SmallInteger(value + 1);\n    return new BigInteger(MAX_INT_ARR, false);\n  };\n\n  BigInteger.prototype.prev = function () {\n    var value = this.value;\n\n    if (this.sign) {\n      return new BigInteger(addSmall(value, 1), true);\n    }\n\n    return subtractSmall(value, 1, this.sign);\n  };\n\n  SmallInteger.prototype.prev = function () {\n    var value = this.value;\n    if (value - 1 > -MAX_INT) return new SmallInteger(value - 1);\n    return new BigInteger(MAX_INT_ARR, true);\n  };\n\n  var powersOfTwo = [1];\n\n  while (2 * powersOfTwo[powersOfTwo.length - 1] <= BASE) powersOfTwo.push(2 * powersOfTwo[powersOfTwo.length - 1]);\n\n  var powers2Length = powersOfTwo.length,\n      highestPower2 = powersOfTwo[powers2Length - 1];\n\n  function shift_isSmall(n) {\n    return (typeof n === \"number\" || typeof n === \"string\") && +Math.abs(n) <= BASE || n instanceof BigInteger && n.value.length <= 1;\n  }\n\n  BigInteger.prototype.shiftLeft = function (n) {\n    if (!shift_isSmall(n)) {\n      throw new Error(String(n) + \" is too large for shifting.\");\n    }\n\n    n = +n;\n    if (n < 0) return this.shiftRight(-n);\n    var result = this;\n    if (result.isZero()) return result;\n\n    while (n >= powers2Length) {\n      result = result.multiply(highestPower2);\n      n -= powers2Length - 1;\n    }\n\n    return result.multiply(powersOfTwo[n]);\n  };\n\n  SmallInteger.prototype.shiftLeft = BigInteger.prototype.shiftLeft;\n\n  BigInteger.prototype.shiftRight = function (n) {\n    var remQuo;\n\n    if (!shift_isSmall(n)) {\n      throw new Error(String(n) + \" is too large for shifting.\");\n    }\n\n    n = +n;\n    if (n < 0) return this.shiftLeft(-n);\n    var result = this;\n\n    while (n >= powers2Length) {\n      if (result.isZero() || result.isNegative() && result.isUnit()) return result;\n      remQuo = divModAny(result, highestPower2);\n      result = remQuo[1].isNegative() ? remQuo[0].prev() : remQuo[0];\n      n -= powers2Length - 1;\n    }\n\n    remQuo = divModAny(result, powersOfTwo[n]);\n    return remQuo[1].isNegative() ? remQuo[0].prev() : remQuo[0];\n  };\n\n  SmallInteger.prototype.shiftRight = BigInteger.prototype.shiftRight;\n\n  function bitwise(x, y, fn) {\n    y = parseValue(y);\n    var xSign = x.isNegative(),\n        ySign = y.isNegative();\n    var xRem = xSign ? x.not() : x,\n        yRem = ySign ? y.not() : y;\n    var xDigit = 0,\n        yDigit = 0;\n    var xDivMod = null,\n        yDivMod = null;\n    var result = [];\n\n    while (!xRem.isZero() || !yRem.isZero()) {\n      xDivMod = divModAny(xRem, highestPower2);\n      xDigit = xDivMod[1].toJSNumber();\n\n      if (xSign) {\n        xDigit = highestPower2 - 1 - xDigit; // two's complement for negative numbers\n      }\n\n      yDivMod = divModAny(yRem, highestPower2);\n      yDigit = yDivMod[1].toJSNumber();\n\n      if (ySign) {\n        yDigit = highestPower2 - 1 - yDigit; // two's complement for negative numbers\n      }\n\n      xRem = xDivMod[0];\n      yRem = yDivMod[0];\n      result.push(fn(xDigit, yDigit));\n    }\n\n    var sum = fn(xSign ? 1 : 0, ySign ? 1 : 0) !== 0 ? bigInt(-1) : bigInt(0);\n\n    for (var i = result.length - 1; i >= 0; i -= 1) {\n      sum = sum.multiply(highestPower2).add(bigInt(result[i]));\n    }\n\n    return sum;\n  }\n\n  BigInteger.prototype.not = function () {\n    return this.negate().prev();\n  };\n\n  SmallInteger.prototype.not = BigInteger.prototype.not;\n\n  BigInteger.prototype.and = function (n) {\n    return bitwise(this, n, function (a, b) {\n      return a & b;\n    });\n  };\n\n  SmallInteger.prototype.and = BigInteger.prototype.and;\n\n  BigInteger.prototype.or = function (n) {\n    return bitwise(this, n, function (a, b) {\n      return a | b;\n    });\n  };\n\n  SmallInteger.prototype.or = BigInteger.prototype.or;\n\n  BigInteger.prototype.xor = function (n) {\n    return bitwise(this, n, function (a, b) {\n      return a ^ b;\n    });\n  };\n\n  SmallInteger.prototype.xor = BigInteger.prototype.xor;\n  var LOBMASK_I = 1 << 30,\n      LOBMASK_BI = (BASE & -BASE) * (BASE & -BASE) | LOBMASK_I;\n\n  function roughLOB(n) {\n    // get lowestOneBit (rough)\n    // SmallInteger: return Min(lowestOneBit(n), 1 << 30)\n    // BigInteger: return Min(lowestOneBit(n), 1 << 14) [BASE=1e7]\n    var v = n.value,\n        x = typeof v === \"number\" ? v | LOBMASK_I : v[0] + v[1] * BASE | LOBMASK_BI;\n    return x & -x;\n  }\n\n  function integerLogarithm(value, base) {\n    if (base.compareTo(value) <= 0) {\n      var tmp = integerLogarithm(value, base.square(base));\n      var p = tmp.p;\n      var e = tmp.e;\n      var t = p.multiply(base);\n      return t.compareTo(value) <= 0 ? {\n        p: t,\n        e: e * 2 + 1\n      } : {\n        p: p,\n        e: e * 2\n      };\n    }\n\n    return {\n      p: bigInt(1),\n      e: 0\n    };\n  }\n\n  BigInteger.prototype.bitLength = function () {\n    var n = this;\n\n    if (n.compareTo(bigInt(0)) < 0) {\n      n = n.negate().subtract(bigInt(1));\n    }\n\n    if (n.compareTo(bigInt(0)) === 0) {\n      return bigInt(0);\n    }\n\n    return bigInt(integerLogarithm(n, bigInt(2)).e).add(bigInt(1));\n  };\n\n  SmallInteger.prototype.bitLength = BigInteger.prototype.bitLength;\n\n  function max(a, b) {\n    a = parseValue(a);\n    b = parseValue(b);\n    return a.greater(b) ? a : b;\n  }\n\n  function min(a, b) {\n    a = parseValue(a);\n    b = parseValue(b);\n    return a.lesser(b) ? a : b;\n  }\n\n  function gcd(a, b) {\n    a = parseValue(a).abs();\n    b = parseValue(b).abs();\n    if (a.equals(b)) return a;\n    if (a.isZero()) return b;\n    if (b.isZero()) return a;\n    var c = Integer[1],\n        d,\n        t;\n\n    while (a.isEven() && b.isEven()) {\n      d = Math.min(roughLOB(a), roughLOB(b));\n      a = a.divide(d);\n      b = b.divide(d);\n      c = c.multiply(d);\n    }\n\n    while (a.isEven()) {\n      a = a.divide(roughLOB(a));\n    }\n\n    do {\n      while (b.isEven()) {\n        b = b.divide(roughLOB(b));\n      }\n\n      if (a.greater(b)) {\n        t = b;\n        b = a;\n        a = t;\n      }\n\n      b = b.subtract(a);\n    } while (!b.isZero());\n\n    return c.isUnit() ? a : a.multiply(c);\n  }\n\n  function lcm(a, b) {\n    a = parseValue(a).abs();\n    b = parseValue(b).abs();\n    return a.divide(gcd(a, b)).multiply(b);\n  }\n\n  function randBetween(a, b) {\n    a = parseValue(a);\n    b = parseValue(b);\n    var low = min(a, b),\n        high = max(a, b);\n    var range = high.subtract(low).add(1);\n    if (range.isSmall) return low.add(Math.floor(Math.random() * range));\n    var length = range.value.length - 1;\n    var result = [],\n        restricted = true;\n\n    for (var i = length; i >= 0; i--) {\n      var top = restricted ? range.value[i] : BASE;\n      var digit = truncate(Math.random() * top);\n      result.unshift(digit);\n      if (digit < top) restricted = false;\n    }\n\n    result = arrayToSmall(result);\n    return low.add(typeof result === \"number\" ? new SmallInteger(result) : new BigInteger(result, false));\n  }\n\n  var parseBase = function (text, base) {\n    var length = text.length;\n    var i;\n    var absBase = Math.abs(base);\n\n    for (var i = 0; i < length; i++) {\n      var c = text[i].toLowerCase();\n      if (c === \"-\") continue;\n\n      if (/[a-z0-9]/.test(c)) {\n        if (/[0-9]/.test(c) && +c >= absBase) {\n          if (c === \"1\" && absBase === 1) continue;\n          throw new Error(c + \" is not a valid digit in base \" + base + \".\");\n        } else if (c.charCodeAt(0) - 87 >= absBase) {\n          throw new Error(c + \" is not a valid digit in base \" + base + \".\");\n        }\n      }\n    }\n\n    if (2 <= base && base <= 36) {\n      if (length <= LOG_MAX_INT / Math.log(base)) {\n        var result = parseInt(text, base);\n\n        if (isNaN(result)) {\n          throw new Error(c + \" is not a valid digit in base \" + base + \".\");\n        }\n\n        return new SmallInteger(parseInt(text, base));\n      }\n    }\n\n    base = parseValue(base);\n    var digits = [];\n    var isNegative = text[0] === \"-\";\n\n    for (i = isNegative ? 1 : 0; i < text.length; i++) {\n      var c = text[i].toLowerCase(),\n          charCode = c.charCodeAt(0);\n      if (48 <= charCode && charCode <= 57) digits.push(parseValue(c));else if (97 <= charCode && charCode <= 122) digits.push(parseValue(c.charCodeAt(0) - 87));else if (c === \"<\") {\n        var start = i;\n\n        do {\n          i++;\n        } while (text[i] !== \">\");\n\n        digits.push(parseValue(text.slice(start + 1, i)));\n      } else throw new Error(c + \" is not a valid character\");\n    }\n\n    return parseBaseFromArray(digits, base, isNegative);\n  };\n\n  function parseBaseFromArray(digits, base, isNegative) {\n    var val = Integer[0],\n        pow = Integer[1],\n        i;\n\n    for (i = digits.length - 1; i >= 0; i--) {\n      val = val.add(digits[i].times(pow));\n      pow = pow.times(base);\n    }\n\n    return isNegative ? val.negate() : val;\n  }\n\n  function stringify(digit) {\n    if (digit <= 35) {\n      return \"0123456789abcdefghijklmnopqrstuvwxyz\".charAt(digit);\n    }\n\n    return \"<\" + digit + \">\";\n  }\n\n  function toBase(n, base) {\n    base = bigInt(base);\n\n    if (base.isZero()) {\n      if (n.isZero()) return {\n        value: [0],\n        isNegative: false\n      };\n      throw new Error(\"Cannot convert nonzero numbers to base 0.\");\n    }\n\n    if (base.equals(-1)) {\n      if (n.isZero()) return {\n        value: [0],\n        isNegative: false\n      };\n      if (n.isNegative()) return {\n        value: [].concat.apply([], Array.apply(null, Array(-n)).map(Array.prototype.valueOf, [1, 0])),\n        isNegative: false\n      };\n      var arr = Array.apply(null, Array(+n - 1)).map(Array.prototype.valueOf, [0, 1]);\n      arr.unshift([1]);\n      return {\n        value: [].concat.apply([], arr),\n        isNegative: false\n      };\n    }\n\n    var neg = false;\n\n    if (n.isNegative() && base.isPositive()) {\n      neg = true;\n      n = n.abs();\n    }\n\n    if (base.equals(1)) {\n      if (n.isZero()) return {\n        value: [0],\n        isNegative: false\n      };\n      return {\n        value: Array.apply(null, Array(+n)).map(Number.prototype.valueOf, 1),\n        isNegative: neg\n      };\n    }\n\n    var out = [];\n    var left = n,\n        divmod;\n\n    while (left.isNegative() || left.compareAbs(base) >= 0) {\n      divmod = left.divmod(base);\n      left = divmod.quotient;\n      var digit = divmod.remainder;\n\n      if (digit.isNegative()) {\n        digit = base.minus(digit).abs();\n        left = left.next();\n      }\n\n      out.push(digit.toJSNumber());\n    }\n\n    out.push(left.toJSNumber());\n    return {\n      value: out.reverse(),\n      isNegative: neg\n    };\n  }\n\n  function toBaseString(n, base) {\n    var arr = toBase(n, base);\n    return (arr.isNegative ? \"-\" : \"\") + arr.value.map(stringify).join('');\n  }\n\n  BigInteger.prototype.toArray = function (radix) {\n    return toBase(this, radix);\n  };\n\n  SmallInteger.prototype.toArray = function (radix) {\n    return toBase(this, radix);\n  };\n\n  BigInteger.prototype.toString = function (radix) {\n    if (radix === undefined) radix = 10;\n    if (radix !== 10) return toBaseString(this, radix);\n    var v = this.value,\n        l = v.length,\n        str = String(v[--l]),\n        zeros = \"0000000\",\n        digit;\n\n    while (--l >= 0) {\n      digit = String(v[l]);\n      str += zeros.slice(digit.length) + digit;\n    }\n\n    var sign = this.sign ? \"-\" : \"\";\n    return sign + str;\n  };\n\n  SmallInteger.prototype.toString = function (radix) {\n    if (radix === undefined) radix = 10;\n    if (radix != 10) return toBaseString(this, radix);\n    return String(this.value);\n  };\n\n  BigInteger.prototype.toJSON = SmallInteger.prototype.toJSON = function () {\n    return this.toString();\n  };\n\n  BigInteger.prototype.valueOf = function () {\n    return parseInt(this.toString(), 10);\n  };\n\n  BigInteger.prototype.toJSNumber = BigInteger.prototype.valueOf;\n\n  SmallInteger.prototype.valueOf = function () {\n    return this.value;\n  };\n\n  SmallInteger.prototype.toJSNumber = SmallInteger.prototype.valueOf;\n\n  function parseStringValue(v) {\n    if (isPrecise(+v)) {\n      var x = +v;\n      if (x === truncate(x)) return new SmallInteger(x);\n      throw new Error(\"Invalid integer: \" + v);\n    }\n\n    var sign = v[0] === \"-\";\n    if (sign) v = v.slice(1);\n    var split = v.split(/e/i);\n    if (split.length > 2) throw new Error(\"Invalid integer: \" + split.join(\"e\"));\n\n    if (split.length === 2) {\n      var exp = split[1];\n      if (exp[0] === \"+\") exp = exp.slice(1);\n      exp = +exp;\n      if (exp !== truncate(exp) || !isPrecise(exp)) throw new Error(\"Invalid integer: \" + exp + \" is not a valid exponent.\");\n      var text = split[0];\n      var decimalPlace = text.indexOf(\".\");\n\n      if (decimalPlace >= 0) {\n        exp -= text.length - decimalPlace - 1;\n        text = text.slice(0, decimalPlace) + text.slice(decimalPlace + 1);\n      }\n\n      if (exp < 0) throw new Error(\"Cannot include negative exponent part for integers\");\n      text += new Array(exp + 1).join(\"0\");\n      v = text;\n    }\n\n    var isValid = /^([0-9][0-9]*)$/.test(v);\n    if (!isValid) throw new Error(\"Invalid integer: \" + v);\n    var r = [],\n        max = v.length,\n        l = LOG_BASE,\n        min = max - l;\n\n    while (max > 0) {\n      r.push(+v.slice(min, max));\n      min -= l;\n      if (min < 0) min = 0;\n      max -= l;\n    }\n\n    trim(r);\n    return new BigInteger(r, sign);\n  }\n\n  function parseNumberValue(v) {\n    if (isPrecise(v)) {\n      if (v !== truncate(v)) throw new Error(v + \" is not an integer.\");\n      return new SmallInteger(v);\n    }\n\n    return parseStringValue(v.toString());\n  }\n\n  function parseValue(v) {\n    if (typeof v === \"number\") {\n      return parseNumberValue(v);\n    }\n\n    if (typeof v === \"string\") {\n      return parseStringValue(v);\n    }\n\n    return v;\n  } // Pre-define numbers in range [-999,999]\n\n\n  for (var i = 0; i < 1000; i++) {\n    Integer[i] = new SmallInteger(i);\n    if (i > 0) Integer[-i] = new SmallInteger(-i);\n  } // Backwards compatibility\n\n\n  Integer.one = Integer[1];\n  Integer.zero = Integer[0];\n  Integer.minusOne = Integer[-1];\n  Integer.max = max;\n  Integer.min = min;\n  Integer.gcd = gcd;\n  Integer.lcm = lcm;\n\n  Integer.isInstance = function (x) {\n    return x instanceof BigInteger || x instanceof SmallInteger;\n  };\n\n  Integer.randBetween = randBetween;\n\n  Integer.fromArray = function (digits, base, isNegative) {\n    return parseBaseFromArray(digits.map(parseValue), parseValue(base || 10), isNegative);\n  };\n\n  return Integer;\n}(); // Node.js check\n\n\nif (typeof module !== \"undefined\" && module.hasOwnProperty(\"exports\")) {\n  module.exports = bigInt;\n} //amd check\n\n\nif (typeof define === \"function\" && define.amd) {\n  define(\"big-integer\", [], function () {\n    return bigInt;\n  });\n}","map":{"version":3,"sources":["/home/abubakar/Desktop/KeyStore-Thorchain/node_modules/big-integer/BigInteger.js"],"names":["bigInt","undefined","BASE","LOG_BASE","MAX_INT","MAX_INT_ARR","smallToArray","LOG_MAX_INT","Math","log","Integer","v","radix","parseValue","parseBase","BigInteger","value","sign","isSmall","prototype","Object","create","SmallInteger","isPrecise","n","floor","arrayToSmall","arr","trim","length","compareAbs","i","createArray","x","Array","truncate","ceil","add","a","b","l_a","l_b","r","carry","base","sum","push","addAny","addSmall","l","subtract","negate","abs","plus","a_l","b_l","borrow","difference","subtractAny","subtractSmall","minus","small","multiplyLong","product","a_i","b_j","j","multiplySmall","shiftLeft","concat","multiplyKaratsuba","y","max","slice","d","c","ac","bd","abcd","useKaratsuba","l1","l2","multiply","times","multiplySmallAndArray","_multiplyBySmall","square","a_j","divMod1","result","divisorMostSignificantDigit","lambda","remainder","divisor","quotientDigit","shift","q","divModSmall","divMod2","part","guess","xlen","highx","highy","check","unshift","reverse","quotient","divModAny","self","Error","comparison","qSign","mod","mSign","divmod","divide","over","pow","isEven","toString","modPow","exp","isZero","isPositive","isOdd","compare","Infinity","compareTo","equals","eq","notEquals","neq","greater","gt","lesser","lt","greaterOrEquals","geq","lesserOrEquals","leq","isNegative","isUnit","isDivisibleBy","isBasicPrime","millerRabinTest","nPrev","prev","t","next","isPrime","strict","bits","bitLength","logN","isProbablePrime","iterations","randBetween","modInv","zero","newT","one","newR","lastT","lastR","powersOfTwo","powers2Length","highestPower2","shift_isSmall","String","shiftRight","remQuo","bitwise","fn","xSign","ySign","xRem","not","yRem","xDigit","yDigit","xDivMod","yDivMod","toJSNumber","and","or","xor","LOBMASK_I","LOBMASK_BI","roughLOB","integerLogarithm","tmp","p","e","min","gcd","lcm","low","high","range","random","restricted","top","digit","text","absBase","toLowerCase","test","charCodeAt","parseInt","isNaN","digits","charCode","start","parseBaseFromArray","val","stringify","charAt","toBase","apply","map","valueOf","neg","Number","out","left","toBaseString","join","toArray","str","zeros","toJSON","parseStringValue","split","decimalPlace","indexOf","isValid","parseNumberValue","minusOne","isInstance","fromArray","module","hasOwnProperty","exports","define","amd"],"mappings":"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","sourcesContent":["var bigInt = (function (undefined) {\r\n    \"use strict\";\r\n\r\n    var BASE = 1e7,\r\n        LOG_BASE = 7,\r\n        MAX_INT = 9007199254740992,\r\n        MAX_INT_ARR = smallToArray(MAX_INT),\r\n        LOG_MAX_INT = Math.log(MAX_INT);\r\n\r\n    function Integer(v, radix) {\r\n        if (typeof v === \"undefined\") return Integer[0];\r\n        if (typeof radix !== \"undefined\") return +radix === 10 ? parseValue(v) : parseBase(v, radix);\r\n        return parseValue(v);\r\n    }\r\n\r\n    function BigInteger(value, sign) {\r\n        this.value = value;\r\n        this.sign = sign;\r\n        this.isSmall = false;\r\n    }\r\n    BigInteger.prototype = Object.create(Integer.prototype);\r\n\r\n    function SmallInteger(value) {\r\n        this.value = value;\r\n        this.sign = value < 0;\r\n        this.isSmall = true;\r\n    }\r\n    SmallInteger.prototype = Object.create(Integer.prototype);\r\n\r\n    function isPrecise(n) {\r\n        return -MAX_INT < n && n < MAX_INT;\r\n    }\r\n\r\n    function smallToArray(n) { // For performance reasons doesn't reference BASE, need to change this function if BASE changes\r\n        if (n < 1e7)\r\n            return [n];\r\n        if (n < 1e14)\r\n            return [n % 1e7, Math.floor(n / 1e7)];\r\n        return [n % 1e7, Math.floor(n / 1e7) % 1e7, Math.floor(n / 1e14)];\r\n    }\r\n\r\n    function arrayToSmall(arr) { // If BASE changes this function may need to change\r\n        trim(arr);\r\n        var length = arr.length;\r\n        if (length < 4 && compareAbs(arr, MAX_INT_ARR) < 0) {\r\n            switch (length) {\r\n                case 0: return 0;\r\n                case 1: return arr[0];\r\n                case 2: return arr[0] + arr[1] * BASE;\r\n                default: return arr[0] + (arr[1] + arr[2] * BASE) * BASE;\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n\r\n    function trim(v) {\r\n        var i = v.length;\r\n        while (v[--i] === 0);\r\n        v.length = i + 1;\r\n    }\r\n\r\n    function createArray(length) { // function shamelessly stolen from Yaffle's library https://github.com/Yaffle/BigInteger\r\n        var x = new Array(length);\r\n        var i = -1;\r\n        while (++i < length) {\r\n            x[i] = 0;\r\n        }\r\n        return x;\r\n    }\r\n\r\n    function truncate(n) {\r\n        if (n > 0) return Math.floor(n);\r\n        return Math.ceil(n);\r\n    }\r\n\r\n    function add(a, b) { // assumes a and b are arrays with a.length >= b.length\r\n        var l_a = a.length,\r\n            l_b = b.length,\r\n            r = new Array(l_a),\r\n            carry = 0,\r\n            base = BASE,\r\n            sum, i;\r\n        for (i = 0; i < l_b; i++) {\r\n            sum = a[i] + b[i] + carry;\r\n            carry = sum >= base ? 1 : 0;\r\n            r[i] = sum - carry * base;\r\n        }\r\n        while (i < l_a) {\r\n            sum = a[i] + carry;\r\n            carry = sum === base ? 1 : 0;\r\n            r[i++] = sum - carry * base;\r\n        }\r\n        if (carry > 0) r.push(carry);\r\n        return r;\r\n    }\r\n\r\n    function addAny(a, b) {\r\n        if (a.length >= b.length) return add(a, b);\r\n        return add(b, a);\r\n    }\r\n\r\n    function addSmall(a, carry) { // assumes a is array, carry is number with 0 <= carry < MAX_INT\r\n        var l = a.length,\r\n            r = new Array(l),\r\n            base = BASE,\r\n            sum, i;\r\n        for (i = 0; i < l; i++) {\r\n            sum = a[i] - base + carry;\r\n            carry = Math.floor(sum / base);\r\n            r[i] = sum - carry * base;\r\n            carry += 1;\r\n        }\r\n        while (carry > 0) {\r\n            r[i++] = carry % base;\r\n            carry = Math.floor(carry / base);\r\n        }\r\n        return r;\r\n    }\r\n\r\n    BigInteger.prototype.add = function (v) {\r\n        var n = parseValue(v);\r\n        if (this.sign !== n.sign) {\r\n            return this.subtract(n.negate());\r\n        }\r\n        var a = this.value, b = n.value;\r\n        if (n.isSmall) {\r\n            return new BigInteger(addSmall(a, Math.abs(b)), this.sign);\r\n        }\r\n        return new BigInteger(addAny(a, b), this.sign);\r\n    };\r\n    BigInteger.prototype.plus = BigInteger.prototype.add;\r\n\r\n    SmallInteger.prototype.add = function (v) {\r\n        var n = parseValue(v);\r\n        var a = this.value;\r\n        if (a < 0 !== n.sign) {\r\n            return this.subtract(n.negate());\r\n        }\r\n        var b = n.value;\r\n        if (n.isSmall) {\r\n            if (isPrecise(a + b)) return new SmallInteger(a + b);\r\n            b = smallToArray(Math.abs(b));\r\n        }\r\n        return new BigInteger(addSmall(b, Math.abs(a)), a < 0);\r\n    };\r\n    SmallInteger.prototype.plus = SmallInteger.prototype.add;\r\n\r\n    function subtract(a, b) { // assumes a and b are arrays with a >= b\r\n        var a_l = a.length,\r\n            b_l = b.length,\r\n            r = new Array(a_l),\r\n            borrow = 0,\r\n            base = BASE,\r\n            i, difference;\r\n        for (i = 0; i < b_l; i++) {\r\n            difference = a[i] - borrow - b[i];\r\n            if (difference < 0) {\r\n                difference += base;\r\n                borrow = 1;\r\n            } else borrow = 0;\r\n            r[i] = difference;\r\n        }\r\n        for (i = b_l; i < a_l; i++) {\r\n            difference = a[i] - borrow;\r\n            if (difference < 0) difference += base;\r\n            else {\r\n                r[i++] = difference;\r\n                break;\r\n            }\r\n            r[i] = difference;\r\n        }\r\n        for (; i < a_l; i++) {\r\n            r[i] = a[i];\r\n        }\r\n        trim(r);\r\n        return r;\r\n    }\r\n\r\n    function subtractAny(a, b, sign) {\r\n        var value;\r\n        if (compareAbs(a, b) >= 0) {\r\n            value = subtract(a, b);\r\n        } else {\r\n            value = subtract(b, a);\r\n            sign = !sign;\r\n        }\r\n        value = arrayToSmall(value);\r\n        if (typeof value === \"number\") {\r\n            if (sign) value = -value;\r\n            return new SmallInteger(value);\r\n        }\r\n        return new BigInteger(value, sign);\r\n    }\r\n\r\n    function subtractSmall(a, b, sign) { // assumes a is array, b is number with 0 <= b < MAX_INT\r\n        var l = a.length,\r\n            r = new Array(l),\r\n            carry = -b,\r\n            base = BASE,\r\n            i, difference;\r\n        for (i = 0; i < l; i++) {\r\n            difference = a[i] + carry;\r\n            carry = Math.floor(difference / base);\r\n            difference %= base;\r\n            r[i] = difference < 0 ? difference + base : difference;\r\n        }\r\n        r = arrayToSmall(r);\r\n        if (typeof r === \"number\") {\r\n            if (sign) r = -r;\r\n            return new SmallInteger(r);\r\n        } return new BigInteger(r, sign);\r\n    }\r\n\r\n    BigInteger.prototype.subtract = function (v) {\r\n        var n = parseValue(v);\r\n        if (this.sign !== n.sign) {\r\n            return this.add(n.negate());\r\n        }\r\n        var a = this.value, b = n.value;\r\n        if (n.isSmall)\r\n            return subtractSmall(a, Math.abs(b), this.sign);\r\n        return subtractAny(a, b, this.sign);\r\n    };\r\n    BigInteger.prototype.minus = BigInteger.prototype.subtract;\r\n\r\n    SmallInteger.prototype.subtract = function (v) {\r\n        var n = parseValue(v);\r\n        var a = this.value;\r\n        if (a < 0 !== n.sign) {\r\n            return this.add(n.negate());\r\n        }\r\n        var b = n.value;\r\n        if (n.isSmall) {\r\n            return new SmallInteger(a - b);\r\n        }\r\n        return subtractSmall(b, Math.abs(a), a >= 0);\r\n    };\r\n    SmallInteger.prototype.minus = SmallInteger.prototype.subtract;\r\n\r\n    BigInteger.prototype.negate = function () {\r\n        return new BigInteger(this.value, !this.sign);\r\n    };\r\n    SmallInteger.prototype.negate = function () {\r\n        var sign = this.sign;\r\n        var small = new SmallInteger(-this.value);\r\n        small.sign = !sign;\r\n        return small;\r\n    };\r\n\r\n    BigInteger.prototype.abs = function () {\r\n        return new BigInteger(this.value, false);\r\n    };\r\n    SmallInteger.prototype.abs = function () {\r\n        return new SmallInteger(Math.abs(this.value));\r\n    };\r\n\r\n    function multiplyLong(a, b) {\r\n        var a_l = a.length,\r\n            b_l = b.length,\r\n            l = a_l + b_l,\r\n            r = createArray(l),\r\n            base = BASE,\r\n            product, carry, i, a_i, b_j;\r\n        for (i = 0; i < a_l; ++i) {\r\n            a_i = a[i];\r\n            for (var j = 0; j < b_l; ++j) {\r\n                b_j = b[j];\r\n                product = a_i * b_j + r[i + j];\r\n                carry = Math.floor(product / base);\r\n                r[i + j] = product - carry * base;\r\n                r[i + j + 1] += carry;\r\n            }\r\n        }\r\n        trim(r);\r\n        return r;\r\n    }\r\n\r\n    function multiplySmall(a, b) { // assumes a is array, b is number with |b| < BASE\r\n        var l = a.length,\r\n            r = new Array(l),\r\n            base = BASE,\r\n            carry = 0,\r\n            product, i;\r\n        for (i = 0; i < l; i++) {\r\n            product = a[i] * b + carry;\r\n            carry = Math.floor(product / base);\r\n            r[i] = product - carry * base;\r\n        }\r\n        while (carry > 0) {\r\n            r[i++] = carry % base;\r\n            carry = Math.floor(carry / base);\r\n        }\r\n        return r;\r\n    }\r\n\r\n    function shiftLeft(x, n) {\r\n        var r = [];\r\n        while (n-- > 0) r.push(0);\r\n        return r.concat(x);\r\n    }\r\n\r\n    function multiplyKaratsuba(x, y) {\r\n        var n = Math.max(x.length, y.length);\r\n\r\n        if (n <= 30) return multiplyLong(x, y);\r\n        n = Math.ceil(n / 2);\r\n\r\n        var b = x.slice(n),\r\n            a = x.slice(0, n),\r\n            d = y.slice(n),\r\n            c = y.slice(0, n);\r\n\r\n        var ac = multiplyKaratsuba(a, c),\r\n            bd = multiplyKaratsuba(b, d),\r\n            abcd = multiplyKaratsuba(addAny(a, b), addAny(c, d));\r\n\r\n        var product = addAny(addAny(ac, shiftLeft(subtract(subtract(abcd, ac), bd), n)), shiftLeft(bd, 2 * n));\r\n        trim(product);\r\n        return product;\r\n    }\r\n\r\n    // The following function is derived from a surface fit of a graph plotting the performance difference\r\n    // between long multiplication and karatsuba multiplication versus the lengths of the two arrays.\r\n    function useKaratsuba(l1, l2) {\r\n        return -0.012 * l1 - 0.012 * l2 + 0.000015 * l1 * l2 > 0;\r\n    }\r\n\r\n    BigInteger.prototype.multiply = function (v) {\r\n        var n = parseValue(v),\r\n            a = this.value, b = n.value,\r\n            sign = this.sign !== n.sign,\r\n            abs;\r\n        if (n.isSmall) {\r\n            if (b === 0) return Integer[0];\r\n            if (b === 1) return this;\r\n            if (b === -1) return this.negate();\r\n            abs = Math.abs(b);\r\n            if (abs < BASE) {\r\n                return new BigInteger(multiplySmall(a, abs), sign);\r\n            }\r\n            b = smallToArray(abs);\r\n        }\r\n        if (useKaratsuba(a.length, b.length)) // Karatsuba is only faster for certain array sizes\r\n            return new BigInteger(multiplyKaratsuba(a, b), sign);\r\n        return new BigInteger(multiplyLong(a, b), sign);\r\n    };\r\n\r\n    BigInteger.prototype.times = BigInteger.prototype.multiply;\r\n\r\n    function multiplySmallAndArray(a, b, sign) { // a >= 0\r\n        if (a < BASE) {\r\n            return new BigInteger(multiplySmall(b, a), sign);\r\n        }\r\n        return new BigInteger(multiplyLong(b, smallToArray(a)), sign);\r\n    }\r\n    SmallInteger.prototype._multiplyBySmall = function (a) {\r\n        if (isPrecise(a.value * this.value)) {\r\n            return new SmallInteger(a.value * this.value);\r\n        }\r\n        return multiplySmallAndArray(Math.abs(a.value), smallToArray(Math.abs(this.value)), this.sign !== a.sign);\r\n    };\r\n    BigInteger.prototype._multiplyBySmall = function (a) {\r\n        if (a.value === 0) return Integer[0];\r\n        if (a.value === 1) return this;\r\n        if (a.value === -1) return this.negate();\r\n        return multiplySmallAndArray(Math.abs(a.value), this.value, this.sign !== a.sign);\r\n    };\r\n    SmallInteger.prototype.multiply = function (v) {\r\n        return parseValue(v)._multiplyBySmall(this);\r\n    };\r\n    SmallInteger.prototype.times = SmallInteger.prototype.multiply;\r\n\r\n    function square(a) {\r\n        //console.assert(2 * BASE * BASE < MAX_INT);\r\n        var l = a.length,\r\n            r = createArray(l + l),\r\n            base = BASE,\r\n            product, carry, i, a_i, a_j;\r\n        for (i = 0; i < l; i++) {\r\n            a_i = a[i];\r\n            carry = 0 - a_i * a_i;\r\n            for (var j = i; j < l; j++) {\r\n                a_j = a[j];\r\n                product = 2 * (a_i * a_j) + r[i + j] + carry;\r\n                carry = Math.floor(product / base);\r\n                r[i + j] = product - carry * base;\r\n            }\r\n            r[i + l] = carry;\r\n        }\r\n        trim(r);\r\n        return r;\r\n    }\r\n\r\n    BigInteger.prototype.square = function () {\r\n        return new BigInteger(square(this.value), false);\r\n    };\r\n\r\n    SmallInteger.prototype.square = function () {\r\n        var value = this.value * this.value;\r\n        if (isPrecise(value)) return new SmallInteger(value);\r\n        return new BigInteger(square(smallToArray(Math.abs(this.value))), false);\r\n    };\r\n\r\n    function divMod1(a, b) { // Left over from previous version. Performs faster than divMod2 on smaller input sizes.\r\n        var a_l = a.length,\r\n            b_l = b.length,\r\n            base = BASE,\r\n            result = createArray(b.length),\r\n            divisorMostSignificantDigit = b[b_l - 1],\r\n            // normalization\r\n            lambda = Math.ceil(base / (2 * divisorMostSignificantDigit)),\r\n            remainder = multiplySmall(a, lambda),\r\n            divisor = multiplySmall(b, lambda),\r\n            quotientDigit, shift, carry, borrow, i, l, q;\r\n        if (remainder.length <= a_l) remainder.push(0);\r\n        divisor.push(0);\r\n        divisorMostSignificantDigit = divisor[b_l - 1];\r\n        for (shift = a_l - b_l; shift >= 0; shift--) {\r\n            quotientDigit = base - 1;\r\n            if (remainder[shift + b_l] !== divisorMostSignificantDigit) {\r\n                quotientDigit = Math.floor((remainder[shift + b_l] * base + remainder[shift + b_l - 1]) / divisorMostSignificantDigit);\r\n            }\r\n            // quotientDigit <= base - 1\r\n            carry = 0;\r\n            borrow = 0;\r\n            l = divisor.length;\r\n            for (i = 0; i < l; i++) {\r\n                carry += quotientDigit * divisor[i];\r\n                q = Math.floor(carry / base);\r\n                borrow += remainder[shift + i] - (carry - q * base);\r\n                carry = q;\r\n                if (borrow < 0) {\r\n                    remainder[shift + i] = borrow + base;\r\n                    borrow = -1;\r\n                } else {\r\n                    remainder[shift + i] = borrow;\r\n                    borrow = 0;\r\n                }\r\n            }\r\n            while (borrow !== 0) {\r\n                quotientDigit -= 1;\r\n                carry = 0;\r\n                for (i = 0; i < l; i++) {\r\n                    carry += remainder[shift + i] - base + divisor[i];\r\n                    if (carry < 0) {\r\n                        remainder[shift + i] = carry + base;\r\n                        carry = 0;\r\n                    } else {\r\n                        remainder[shift + i] = carry;\r\n                        carry = 1;\r\n                    }\r\n                }\r\n                borrow += carry;\r\n            }\r\n            result[shift] = quotientDigit;\r\n        }\r\n        // denormalization\r\n        remainder = divModSmall(remainder, lambda)[0];\r\n        return [arrayToSmall(result), arrayToSmall(remainder)];\r\n    }\r\n\r\n    function divMod2(a, b) { // Implementation idea shamelessly stolen from Silent Matt's library http://silentmatt.com/biginteger/\r\n        // Performs faster than divMod1 on larger input sizes.\r\n        var a_l = a.length,\r\n            b_l = b.length,\r\n            result = [],\r\n            part = [],\r\n            base = BASE,\r\n            guess, xlen, highx, highy, check;\r\n        while (a_l) {\r\n            part.unshift(a[--a_l]);\r\n            trim(part);\r\n            if (compareAbs(part, b) < 0) {\r\n                result.push(0);\r\n                continue;\r\n            }\r\n            xlen = part.length;\r\n            highx = part[xlen - 1] * base + part[xlen - 2];\r\n            highy = b[b_l - 1] * base + b[b_l - 2];\r\n            if (xlen > b_l) {\r\n                highx = (highx + 1) * base;\r\n            }\r\n            guess = Math.ceil(highx / highy);\r\n            do {\r\n                check = multiplySmall(b, guess);\r\n                if (compareAbs(check, part) <= 0) break;\r\n                guess--;\r\n            } while (guess);\r\n            result.push(guess);\r\n            part = subtract(part, check);\r\n        }\r\n        result.reverse();\r\n        return [arrayToSmall(result), arrayToSmall(part)];\r\n    }\r\n\r\n    function divModSmall(value, lambda) {\r\n        var length = value.length,\r\n            quotient = createArray(length),\r\n            base = BASE,\r\n            i, q, remainder, divisor;\r\n        remainder = 0;\r\n        for (i = length - 1; i >= 0; --i) {\r\n            divisor = remainder * base + value[i];\r\n            q = truncate(divisor / lambda);\r\n            remainder = divisor - q * lambda;\r\n            quotient[i] = q | 0;\r\n        }\r\n        return [quotient, remainder | 0];\r\n    }\r\n\r\n    function divModAny(self, v) {\r\n        var value, n = parseValue(v);\r\n        var a = self.value, b = n.value;\r\n        var quotient;\r\n        if (b === 0) throw new Error(\"Cannot divide by zero\");\r\n        if (self.isSmall) {\r\n            if (n.isSmall) {\r\n                return [new SmallInteger(truncate(a / b)), new SmallInteger(a % b)];\r\n            }\r\n            return [Integer[0], self];\r\n        }\r\n        if (n.isSmall) {\r\n            if (b === 1) return [self, Integer[0]];\r\n            if (b == -1) return [self.negate(), Integer[0]];\r\n            var abs = Math.abs(b);\r\n            if (abs < BASE) {\r\n                value = divModSmall(a, abs);\r\n                quotient = arrayToSmall(value[0]);\r\n                var remainder = value[1];\r\n                if (self.sign) remainder = -remainder;\r\n                if (typeof quotient === \"number\") {\r\n                    if (self.sign !== n.sign) quotient = -quotient;\r\n                    return [new SmallInteger(quotient), new SmallInteger(remainder)];\r\n                }\r\n                return [new BigInteger(quotient, self.sign !== n.sign), new SmallInteger(remainder)];\r\n            }\r\n            b = smallToArray(abs);\r\n        }\r\n        var comparison = compareAbs(a, b);\r\n        if (comparison === -1) return [Integer[0], self];\r\n        if (comparison === 0) return [Integer[self.sign === n.sign ? 1 : -1], Integer[0]];\r\n\r\n        // divMod1 is faster on smaller input sizes\r\n        if (a.length + b.length <= 200)\r\n            value = divMod1(a, b);\r\n        else value = divMod2(a, b);\r\n\r\n        quotient = value[0];\r\n        var qSign = self.sign !== n.sign,\r\n            mod = value[1],\r\n            mSign = self.sign;\r\n        if (typeof quotient === \"number\") {\r\n            if (qSign) quotient = -quotient;\r\n            quotient = new SmallInteger(quotient);\r\n        } else quotient = new BigInteger(quotient, qSign);\r\n        if (typeof mod === \"number\") {\r\n            if (mSign) mod = -mod;\r\n            mod = new SmallInteger(mod);\r\n        } else mod = new BigInteger(mod, mSign);\r\n        return [quotient, mod];\r\n    }\r\n\r\n    BigInteger.prototype.divmod = function (v) {\r\n        var result = divModAny(this, v);\r\n        return {\r\n            quotient: result[0],\r\n            remainder: result[1]\r\n        };\r\n    };\r\n    SmallInteger.prototype.divmod = BigInteger.prototype.divmod;\r\n\r\n    BigInteger.prototype.divide = function (v) {\r\n        return divModAny(this, v)[0];\r\n    };\r\n    SmallInteger.prototype.over = SmallInteger.prototype.divide = BigInteger.prototype.over = BigInteger.prototype.divide;\r\n\r\n    BigInteger.prototype.mod = function (v) {\r\n        return divModAny(this, v)[1];\r\n    };\r\n    SmallInteger.prototype.remainder = SmallInteger.prototype.mod = BigInteger.prototype.remainder = BigInteger.prototype.mod;\r\n\r\n    BigInteger.prototype.pow = function (v) {\r\n        var n = parseValue(v),\r\n            a = this.value,\r\n            b = n.value,\r\n            value, x, y;\r\n        if (b === 0) return Integer[1];\r\n        if (a === 0) return Integer[0];\r\n        if (a === 1) return Integer[1];\r\n        if (a === -1) return n.isEven() ? Integer[1] : Integer[-1];\r\n        if (n.sign) {\r\n            return Integer[0];\r\n        }\r\n        if (!n.isSmall) throw new Error(\"The exponent \" + n.toString() + \" is too large.\");\r\n        if (this.isSmall) {\r\n            if (isPrecise(value = Math.pow(a, b)))\r\n                return new SmallInteger(truncate(value));\r\n        }\r\n        x = this;\r\n        y = Integer[1];\r\n        while (true) {\r\n            if (b & 1 === 1) {\r\n                y = y.times(x);\r\n                --b;\r\n            }\r\n            if (b === 0) break;\r\n            b /= 2;\r\n            x = x.square();\r\n        }\r\n        return y;\r\n    };\r\n    SmallInteger.prototype.pow = BigInteger.prototype.pow;\r\n\r\n    BigInteger.prototype.modPow = function (exp, mod) {\r\n        exp = parseValue(exp);\r\n        mod = parseValue(mod);\r\n        if (mod.isZero()) throw new Error(\"Cannot take modPow with modulus 0\");\r\n        var r = Integer[1],\r\n            base = this.mod(mod);\r\n        while (exp.isPositive()) {\r\n            if (base.isZero()) return Integer[0];\r\n            if (exp.isOdd()) r = r.multiply(base).mod(mod);\r\n            exp = exp.divide(2);\r\n            base = base.square().mod(mod);\r\n        }\r\n        return r;\r\n    };\r\n    SmallInteger.prototype.modPow = BigInteger.prototype.modPow;\r\n\r\n    function compareAbs(a, b) {\r\n        if (a.length !== b.length) {\r\n            return a.length > b.length ? 1 : -1;\r\n        }\r\n        for (var i = a.length - 1; i >= 0; i--) {\r\n            if (a[i] !== b[i]) return a[i] > b[i] ? 1 : -1;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    BigInteger.prototype.compareAbs = function (v) {\r\n        var n = parseValue(v),\r\n            a = this.value,\r\n            b = n.value;\r\n        if (n.isSmall) return 1;\r\n        return compareAbs(a, b);\r\n    };\r\n    SmallInteger.prototype.compareAbs = function (v) {\r\n        var n = parseValue(v),\r\n            a = Math.abs(this.value),\r\n            b = n.value;\r\n        if (n.isSmall) {\r\n            b = Math.abs(b);\r\n            return a === b ? 0 : a > b ? 1 : -1;\r\n        }\r\n        return -1;\r\n    };\r\n\r\n    BigInteger.prototype.compare = function (v) {\r\n        // See discussion about comparison with Infinity:\r\n        // https://github.com/peterolson/BigInteger.js/issues/61\r\n        if (v === Infinity) {\r\n            return -1;\r\n        }\r\n        if (v === -Infinity) {\r\n            return 1;\r\n        }\r\n\r\n        var n = parseValue(v),\r\n            a = this.value,\r\n            b = n.value;\r\n        if (this.sign !== n.sign) {\r\n            return n.sign ? 1 : -1;\r\n        }\r\n        if (n.isSmall) {\r\n            return this.sign ? -1 : 1;\r\n        }\r\n        return compareAbs(a, b) * (this.sign ? -1 : 1);\r\n    };\r\n    BigInteger.prototype.compareTo = BigInteger.prototype.compare;\r\n\r\n    SmallInteger.prototype.compare = function (v) {\r\n        if (v === Infinity) {\r\n            return -1;\r\n        }\r\n        if (v === -Infinity) {\r\n            return 1;\r\n        }\r\n\r\n        var n = parseValue(v),\r\n            a = this.value,\r\n            b = n.value;\r\n        if (n.isSmall) {\r\n            return a == b ? 0 : a > b ? 1 : -1;\r\n        }\r\n        if (a < 0 !== n.sign) {\r\n            return a < 0 ? -1 : 1;\r\n        }\r\n        return a < 0 ? 1 : -1;\r\n    };\r\n    SmallInteger.prototype.compareTo = SmallInteger.prototype.compare;\r\n\r\n    BigInteger.prototype.equals = function (v) {\r\n        return this.compare(v) === 0;\r\n    };\r\n    SmallInteger.prototype.eq = SmallInteger.prototype.equals = BigInteger.prototype.eq = BigInteger.prototype.equals;\r\n\r\n    BigInteger.prototype.notEquals = function (v) {\r\n        return this.compare(v) !== 0;\r\n    };\r\n    SmallInteger.prototype.neq = SmallInteger.prototype.notEquals = BigInteger.prototype.neq = BigInteger.prototype.notEquals;\r\n\r\n    BigInteger.prototype.greater = function (v) {\r\n        return this.compare(v) > 0;\r\n    };\r\n    SmallInteger.prototype.gt = SmallInteger.prototype.greater = BigInteger.prototype.gt = BigInteger.prototype.greater;\r\n\r\n    BigInteger.prototype.lesser = function (v) {\r\n        return this.compare(v) < 0;\r\n    };\r\n    SmallInteger.prototype.lt = SmallInteger.prototype.lesser = BigInteger.prototype.lt = BigInteger.prototype.lesser;\r\n\r\n    BigInteger.prototype.greaterOrEquals = function (v) {\r\n        return this.compare(v) >= 0;\r\n    };\r\n    SmallInteger.prototype.geq = SmallInteger.prototype.greaterOrEquals = BigInteger.prototype.geq = BigInteger.prototype.greaterOrEquals;\r\n\r\n    BigInteger.prototype.lesserOrEquals = function (v) {\r\n        return this.compare(v) <= 0;\r\n    };\r\n    SmallInteger.prototype.leq = SmallInteger.prototype.lesserOrEquals = BigInteger.prototype.leq = BigInteger.prototype.lesserOrEquals;\r\n\r\n    BigInteger.prototype.isEven = function () {\r\n        return (this.value[0] & 1) === 0;\r\n    };\r\n    SmallInteger.prototype.isEven = function () {\r\n        return (this.value & 1) === 0;\r\n    };\r\n\r\n    BigInteger.prototype.isOdd = function () {\r\n        return (this.value[0] & 1) === 1;\r\n    };\r\n    SmallInteger.prototype.isOdd = function () {\r\n        return (this.value & 1) === 1;\r\n    };\r\n\r\n    BigInteger.prototype.isPositive = function () {\r\n        return !this.sign;\r\n    };\r\n    SmallInteger.prototype.isPositive = function () {\r\n        return this.value > 0;\r\n    };\r\n\r\n    BigInteger.prototype.isNegative = function () {\r\n        return this.sign;\r\n    };\r\n    SmallInteger.prototype.isNegative = function () {\r\n        return this.value < 0;\r\n    };\r\n\r\n    BigInteger.prototype.isUnit = function () {\r\n        return false;\r\n    };\r\n    SmallInteger.prototype.isUnit = function () {\r\n        return Math.abs(this.value) === 1;\r\n    };\r\n\r\n    BigInteger.prototype.isZero = function () {\r\n        return false;\r\n    };\r\n    SmallInteger.prototype.isZero = function () {\r\n        return this.value === 0;\r\n    };\r\n    BigInteger.prototype.isDivisibleBy = function (v) {\r\n        var n = parseValue(v);\r\n        var value = n.value;\r\n        if (value === 0) return false;\r\n        if (value === 1) return true;\r\n        if (value === 2) return this.isEven();\r\n        return this.mod(n).equals(Integer[0]);\r\n    };\r\n    SmallInteger.prototype.isDivisibleBy = BigInteger.prototype.isDivisibleBy;\r\n\r\n    function isBasicPrime(v) {\r\n        var n = v.abs();\r\n        if (n.isUnit()) return false;\r\n        if (n.equals(2) || n.equals(3) || n.equals(5)) return true;\r\n        if (n.isEven() || n.isDivisibleBy(3) || n.isDivisibleBy(5)) return false;\r\n        if (n.lesser(49)) return true;\r\n        // we don't know if it's prime: let the other functions figure it out\r\n    }\r\n    \r\n    function millerRabinTest(n, a) {\r\n        var nPrev = n.prev(),\r\n            b = nPrev,\r\n            r = 0,\r\n            d, t, i, x;\r\n        while (b.isEven()) b = b.divide(2), r++;\r\n        next : for (i = 0; i < a.length; i++) {\r\n            if (n.lesser(a[i])) continue;\r\n            x = bigInt(a[i]).modPow(b, n);\r\n            if (x.equals(Integer[1]) || x.equals(nPrev)) continue;\r\n            for (d = r - 1; d != 0; d--) {\r\n                x = x.square().mod(n);\r\n                if (x.isUnit()) return false;    \r\n                if (x.equals(nPrev)) continue next;\r\n            }\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    \r\n// Set \"strict\" to true to force GRH-supported lower bound of 2*log(N)^2\r\n    BigInteger.prototype.isPrime = function (strict) {\r\n        var isPrime = isBasicPrime(this);\r\n        if (isPrime !== undefined) return isPrime;\r\n        var n = this.abs();\r\n        var bits = n.bitLength();\r\n        if(bits <= 64)\r\n            return millerRabinTest(n, [2, 325, 9375, 28178, 450775, 9780504, 1795265022]);\r\n        var logN = Math.log(2) * bits;\r\n        var t = Math.ceil((strict === true) ? (2 * Math.pow(logN, 2)) : logN);\r\n        for (var a = [], i = 0; i < t; i++) {\r\n            a.push(bigInt(i + 2));\r\n        }\r\n        return millerRabinTest(n, a);\r\n    };\r\n    SmallInteger.prototype.isPrime = BigInteger.prototype.isPrime;\r\n\r\n    BigInteger.prototype.isProbablePrime = function (iterations) {\r\n        var isPrime = isBasicPrime(this);\r\n        if (isPrime !== undefined) return isPrime;\r\n        var n = this.abs();\r\n        var t = iterations === undefined ? 5 : iterations;\r\n        for (var a = [], i = 0; i < t; i++) {\r\n            a.push(bigInt.randBetween(2, n.minus(2)));\r\n        }\r\n        return millerRabinTest(n, a);\r\n    };\r\n    SmallInteger.prototype.isProbablePrime = BigInteger.prototype.isProbablePrime;\r\n\r\n    BigInteger.prototype.modInv = function (n) {\r\n        var t = bigInt.zero, newT = bigInt.one, r = parseValue(n), newR = this.abs(), q, lastT, lastR;\r\n        while (!newR.equals(bigInt.zero)) {\r\n            q = r.divide(newR);\r\n            lastT = t;\r\n            lastR = r;\r\n            t = newT;\r\n            r = newR;\r\n            newT = lastT.subtract(q.multiply(newT));\r\n            newR = lastR.subtract(q.multiply(newR));\r\n        }\r\n        if (!r.equals(1)) throw new Error(this.toString() + \" and \" + n.toString() + \" are not co-prime\");\r\n        if (t.compare(0) === -1) {\r\n            t = t.add(n);\r\n        }\r\n        if (this.isNegative()) {\r\n            return t.negate();\r\n        }\r\n        return t;\r\n    };\r\n\r\n    SmallInteger.prototype.modInv = BigInteger.prototype.modInv;\r\n\r\n    BigInteger.prototype.next = function () {\r\n        var value = this.value;\r\n        if (this.sign) {\r\n            return subtractSmall(value, 1, this.sign);\r\n        }\r\n        return new BigInteger(addSmall(value, 1), this.sign);\r\n    };\r\n    SmallInteger.prototype.next = function () {\r\n        var value = this.value;\r\n        if (value + 1 < MAX_INT) return new SmallInteger(value + 1);\r\n        return new BigInteger(MAX_INT_ARR, false);\r\n    };\r\n\r\n    BigInteger.prototype.prev = function () {\r\n        var value = this.value;\r\n        if (this.sign) {\r\n            return new BigInteger(addSmall(value, 1), true);\r\n        }\r\n        return subtractSmall(value, 1, this.sign);\r\n    };\r\n    SmallInteger.prototype.prev = function () {\r\n        var value = this.value;\r\n        if (value - 1 > -MAX_INT) return new SmallInteger(value - 1);\r\n        return new BigInteger(MAX_INT_ARR, true);\r\n    };\r\n\r\n    var powersOfTwo = [1];\r\n    while (2 * powersOfTwo[powersOfTwo.length - 1] <= BASE) powersOfTwo.push(2 * powersOfTwo[powersOfTwo.length - 1]);\r\n    var powers2Length = powersOfTwo.length, highestPower2 = powersOfTwo[powers2Length - 1];\r\n\r\n    function shift_isSmall(n) {\r\n        return ((typeof n === \"number\" || typeof n === \"string\") && +Math.abs(n) <= BASE) ||\r\n            (n instanceof BigInteger && n.value.length <= 1);\r\n    }\r\n\r\n    BigInteger.prototype.shiftLeft = function (n) {\r\n        if (!shift_isSmall(n)) {\r\n            throw new Error(String(n) + \" is too large for shifting.\");\r\n        }\r\n        n = +n;\r\n        if (n < 0) return this.shiftRight(-n);\r\n        var result = this;\r\n        if (result.isZero()) return result;\r\n        while (n >= powers2Length) {\r\n            result = result.multiply(highestPower2);\r\n            n -= powers2Length - 1;\r\n        }\r\n        return result.multiply(powersOfTwo[n]);\r\n    };\r\n    SmallInteger.prototype.shiftLeft = BigInteger.prototype.shiftLeft;\r\n\r\n    BigInteger.prototype.shiftRight = function (n) {\r\n        var remQuo;\r\n        if (!shift_isSmall(n)) {\r\n            throw new Error(String(n) + \" is too large for shifting.\");\r\n        }\r\n        n = +n;\r\n        if (n < 0) return this.shiftLeft(-n);\r\n        var result = this;\r\n        while (n >= powers2Length) {\r\n            if (result.isZero() || (result.isNegative() && result.isUnit())) return result;\r\n            remQuo = divModAny(result, highestPower2);\r\n            result = remQuo[1].isNegative() ? remQuo[0].prev() : remQuo[0];\r\n            n -= powers2Length - 1;\r\n        }\r\n        remQuo = divModAny(result, powersOfTwo[n]);\r\n        return remQuo[1].isNegative() ? remQuo[0].prev() : remQuo[0];\r\n    };\r\n    SmallInteger.prototype.shiftRight = BigInteger.prototype.shiftRight;\r\n\r\n    function bitwise(x, y, fn) {\r\n        y = parseValue(y);\r\n        var xSign = x.isNegative(), ySign = y.isNegative();\r\n        var xRem = xSign ? x.not() : x,\r\n            yRem = ySign ? y.not() : y;\r\n        var xDigit = 0, yDigit = 0;\r\n        var xDivMod = null, yDivMod = null;\r\n        var result = [];\r\n        while (!xRem.isZero() || !yRem.isZero()) {\r\n            xDivMod = divModAny(xRem, highestPower2);\r\n            xDigit = xDivMod[1].toJSNumber();\r\n            if (xSign) {\r\n                xDigit = highestPower2 - 1 - xDigit; // two's complement for negative numbers\r\n            }\r\n\r\n            yDivMod = divModAny(yRem, highestPower2);\r\n            yDigit = yDivMod[1].toJSNumber();\r\n            if (ySign) {\r\n                yDigit = highestPower2 - 1 - yDigit; // two's complement for negative numbers\r\n            }\r\n\r\n            xRem = xDivMod[0];\r\n            yRem = yDivMod[0];\r\n            result.push(fn(xDigit, yDigit));\r\n        }\r\n        var sum = fn(xSign ? 1 : 0, ySign ? 1 : 0) !== 0 ? bigInt(-1) : bigInt(0);\r\n        for (var i = result.length - 1; i >= 0; i -= 1) {\r\n            sum = sum.multiply(highestPower2).add(bigInt(result[i]));\r\n        }\r\n        return sum;\r\n    }\r\n\r\n    BigInteger.prototype.not = function () {\r\n        return this.negate().prev();\r\n    };\r\n    SmallInteger.prototype.not = BigInteger.prototype.not;\r\n\r\n    BigInteger.prototype.and = function (n) {\r\n        return bitwise(this, n, function (a, b) { return a & b; });\r\n    };\r\n    SmallInteger.prototype.and = BigInteger.prototype.and;\r\n\r\n    BigInteger.prototype.or = function (n) {\r\n        return bitwise(this, n, function (a, b) { return a | b; });\r\n    };\r\n    SmallInteger.prototype.or = BigInteger.prototype.or;\r\n\r\n    BigInteger.prototype.xor = function (n) {\r\n        return bitwise(this, n, function (a, b) { return a ^ b; });\r\n    };\r\n    SmallInteger.prototype.xor = BigInteger.prototype.xor;\r\n\r\n    var LOBMASK_I = 1 << 30, LOBMASK_BI = (BASE & -BASE) * (BASE & -BASE) | LOBMASK_I;\r\n    function roughLOB(n) { // get lowestOneBit (rough)\r\n        // SmallInteger: return Min(lowestOneBit(n), 1 << 30)\r\n        // BigInteger: return Min(lowestOneBit(n), 1 << 14) [BASE=1e7]\r\n        var v = n.value, x = typeof v === \"number\" ? v | LOBMASK_I : v[0] + v[1] * BASE | LOBMASK_BI;\r\n        return x & -x;\r\n    }\r\n\r\n    function integerLogarithm(value, base) {\r\n        if (base.compareTo(value) <= 0) {\r\n            var tmp = integerLogarithm(value, base.square(base));\r\n            var p = tmp.p;\r\n            var e = tmp.e;\r\n            var t = p.multiply(base);\r\n            return t.compareTo(value) <= 0 ? { p: t, e: e * 2 + 1 } : { p: p, e: e * 2 };\r\n        }\r\n        return { p: bigInt(1), e: 0 };\r\n    }\r\n\r\n    BigInteger.prototype.bitLength = function () {\r\n        var n = this;\r\n        if (n.compareTo(bigInt(0)) < 0) {\r\n            n = n.negate().subtract(bigInt(1));\r\n        }\r\n        if (n.compareTo(bigInt(0)) === 0) {\r\n            return bigInt(0);\r\n        }\r\n        return bigInt(integerLogarithm(n, bigInt(2)).e).add(bigInt(1));\r\n    }\r\n    SmallInteger.prototype.bitLength = BigInteger.prototype.bitLength;\r\n\r\n    function max(a, b) {\r\n        a = parseValue(a);\r\n        b = parseValue(b);\r\n        return a.greater(b) ? a : b;\r\n    }\r\n    function min(a, b) {\r\n        a = parseValue(a);\r\n        b = parseValue(b);\r\n        return a.lesser(b) ? a : b;\r\n    }\r\n    function gcd(a, b) {\r\n        a = parseValue(a).abs();\r\n        b = parseValue(b).abs();\r\n        if (a.equals(b)) return a;\r\n        if (a.isZero()) return b;\r\n        if (b.isZero()) return a;\r\n        var c = Integer[1], d, t;\r\n        while (a.isEven() && b.isEven()) {\r\n            d = Math.min(roughLOB(a), roughLOB(b));\r\n            a = a.divide(d);\r\n            b = b.divide(d);\r\n            c = c.multiply(d);\r\n        }\r\n        while (a.isEven()) {\r\n            a = a.divide(roughLOB(a));\r\n        }\r\n        do {\r\n            while (b.isEven()) {\r\n                b = b.divide(roughLOB(b));\r\n            }\r\n            if (a.greater(b)) {\r\n                t = b; b = a; a = t;\r\n            }\r\n            b = b.subtract(a);\r\n        } while (!b.isZero());\r\n        return c.isUnit() ? a : a.multiply(c);\r\n    }\r\n    function lcm(a, b) {\r\n        a = parseValue(a).abs();\r\n        b = parseValue(b).abs();\r\n        return a.divide(gcd(a, b)).multiply(b);\r\n    }\r\n    function randBetween(a, b) {\r\n        a = parseValue(a);\r\n        b = parseValue(b);\r\n        var low = min(a, b), high = max(a, b);\r\n        var range = high.subtract(low).add(1);\r\n        if (range.isSmall) return low.add(Math.floor(Math.random() * range));\r\n        var length = range.value.length - 1;\r\n        var result = [], restricted = true;\r\n        for (var i = length; i >= 0; i--) {\r\n            var top = restricted ? range.value[i] : BASE;\r\n            var digit = truncate(Math.random() * top);\r\n            result.unshift(digit);\r\n            if (digit < top) restricted = false;\r\n        }\r\n        result = arrayToSmall(result);\r\n        return low.add(typeof result === \"number\" ? new SmallInteger(result) : new BigInteger(result, false));\r\n    }\r\n    var parseBase = function (text, base) {\r\n        var length = text.length;\r\n        var i;\r\n        var absBase = Math.abs(base);\r\n        for (var i = 0; i < length; i++) {\r\n            var c = text[i].toLowerCase();\r\n            if (c === \"-\") continue;\r\n            if (/[a-z0-9]/.test(c)) {\r\n                if (/[0-9]/.test(c) && +c >= absBase) {\r\n                    if (c === \"1\" && absBase === 1) continue;\r\n                    throw new Error(c + \" is not a valid digit in base \" + base + \".\");\r\n                } else if (c.charCodeAt(0) - 87 >= absBase) {\r\n                    throw new Error(c + \" is not a valid digit in base \" + base + \".\");\r\n                }\r\n            }\r\n        }\r\n        if (2 <= base && base <= 36) {\r\n            if (length <= LOG_MAX_INT / Math.log(base)) {\r\n                var result = parseInt(text, base);\r\n                if (isNaN(result)) {\r\n                    throw new Error(c + \" is not a valid digit in base \" + base + \".\");\r\n                }\r\n                return new SmallInteger(parseInt(text, base));\r\n            }\r\n        }\r\n        base = parseValue(base);\r\n        var digits = [];\r\n        var isNegative = text[0] === \"-\";\r\n        for (i = isNegative ? 1 : 0; i < text.length; i++) {\r\n            var c = text[i].toLowerCase(),\r\n                charCode = c.charCodeAt(0);\r\n            if (48 <= charCode && charCode <= 57) digits.push(parseValue(c));\r\n            else if (97 <= charCode && charCode <= 122) digits.push(parseValue(c.charCodeAt(0) - 87));\r\n            else if (c === \"<\") {\r\n                var start = i;\r\n                do { i++; } while (text[i] !== \">\");\r\n                digits.push(parseValue(text.slice(start + 1, i)));\r\n            }\r\n            else throw new Error(c + \" is not a valid character\");\r\n        }\r\n        return parseBaseFromArray(digits, base, isNegative);\r\n    };\r\n\r\n    function parseBaseFromArray(digits, base, isNegative) {\r\n        var val = Integer[0], pow = Integer[1], i;\r\n        for (i = digits.length - 1; i >= 0; i--) {\r\n            val = val.add(digits[i].times(pow));\r\n            pow = pow.times(base);\r\n        }\r\n        return isNegative ? val.negate() : val;\r\n    }\r\n\r\n    function stringify(digit) {\r\n        if (digit <= 35) {\r\n            return \"0123456789abcdefghijklmnopqrstuvwxyz\".charAt(digit);\r\n        }\r\n        return \"<\" + digit + \">\";\r\n    }\r\n\r\n    function toBase(n, base) {\r\n        base = bigInt(base);\r\n        if (base.isZero()) {\r\n            if (n.isZero()) return { value: [0], isNegative: false };\r\n            throw new Error(\"Cannot convert nonzero numbers to base 0.\");\r\n        }\r\n        if (base.equals(-1)) {\r\n            if (n.isZero()) return { value: [0], isNegative: false };\r\n            if (n.isNegative())\r\n                return {\r\n                    value: [].concat.apply([], Array.apply(null, Array(-n))\r\n                        .map(Array.prototype.valueOf, [1, 0])\r\n                    ),\r\n                    isNegative: false\r\n                };\r\n\r\n            var arr = Array.apply(null, Array(+n - 1))\r\n                .map(Array.prototype.valueOf, [0, 1]);\r\n            arr.unshift([1]);\r\n            return {\r\n                value: [].concat.apply([], arr),\r\n                isNegative: false\r\n            };\r\n        }\r\n\r\n        var neg = false;\r\n        if (n.isNegative() && base.isPositive()) {\r\n            neg = true;\r\n            n = n.abs();\r\n        }\r\n        if (base.equals(1)) {\r\n            if (n.isZero()) return { value: [0], isNegative: false };\r\n\r\n            return {\r\n                value: Array.apply(null, Array(+n))\r\n                    .map(Number.prototype.valueOf, 1),\r\n                isNegative: neg\r\n            };\r\n        }\r\n        var out = [];\r\n        var left = n, divmod;\r\n        while (left.isNegative() || left.compareAbs(base) >= 0) {\r\n            divmod = left.divmod(base);\r\n            left = divmod.quotient;\r\n            var digit = divmod.remainder;\r\n            if (digit.isNegative()) {\r\n                digit = base.minus(digit).abs();\r\n                left = left.next();\r\n            }\r\n            out.push(digit.toJSNumber());\r\n        }\r\n        out.push(left.toJSNumber());\r\n        return { value: out.reverse(), isNegative: neg };\r\n    }\r\n\r\n    function toBaseString(n, base) {\r\n        var arr = toBase(n, base);\r\n        return (arr.isNegative ? \"-\" : \"\") + arr.value.map(stringify).join('');\r\n    }\r\n\r\n    BigInteger.prototype.toArray = function (radix) {\r\n        return toBase(this, radix);\r\n    };\r\n\r\n    SmallInteger.prototype.toArray = function (radix) {\r\n        return toBase(this, radix);\r\n    };\r\n\r\n    BigInteger.prototype.toString = function (radix) {\r\n        if (radix === undefined) radix = 10;\r\n        if (radix !== 10) return toBaseString(this, radix);\r\n        var v = this.value, l = v.length, str = String(v[--l]), zeros = \"0000000\", digit;\r\n        while (--l >= 0) {\r\n            digit = String(v[l]);\r\n            str += zeros.slice(digit.length) + digit;\r\n        }\r\n        var sign = this.sign ? \"-\" : \"\";\r\n        return sign + str;\r\n    };\r\n\r\n    SmallInteger.prototype.toString = function (radix) {\r\n        if (radix === undefined) radix = 10;\r\n        if (radix != 10) return toBaseString(this, radix);\r\n        return String(this.value);\r\n    };\r\n    BigInteger.prototype.toJSON = SmallInteger.prototype.toJSON = function () { return this.toString(); }\r\n\r\n    BigInteger.prototype.valueOf = function () {\r\n        return parseInt(this.toString(), 10);\r\n    };\r\n    BigInteger.prototype.toJSNumber = BigInteger.prototype.valueOf;\r\n\r\n    SmallInteger.prototype.valueOf = function () {\r\n        return this.value;\r\n    };\r\n    SmallInteger.prototype.toJSNumber = SmallInteger.prototype.valueOf;\r\n\r\n    function parseStringValue(v) {\r\n        if (isPrecise(+v)) {\r\n            var x = +v;\r\n            if (x === truncate(x))\r\n                return new SmallInteger(x);\r\n            throw new Error(\"Invalid integer: \" + v);\r\n        }\r\n        var sign = v[0] === \"-\";\r\n        if (sign) v = v.slice(1);\r\n        var split = v.split(/e/i);\r\n        if (split.length > 2) throw new Error(\"Invalid integer: \" + split.join(\"e\"));\r\n        if (split.length === 2) {\r\n            var exp = split[1];\r\n            if (exp[0] === \"+\") exp = exp.slice(1);\r\n            exp = +exp;\r\n            if (exp !== truncate(exp) || !isPrecise(exp)) throw new Error(\"Invalid integer: \" + exp + \" is not a valid exponent.\");\r\n            var text = split[0];\r\n            var decimalPlace = text.indexOf(\".\");\r\n            if (decimalPlace >= 0) {\r\n                exp -= text.length - decimalPlace - 1;\r\n                text = text.slice(0, decimalPlace) + text.slice(decimalPlace + 1);\r\n            }\r\n            if (exp < 0) throw new Error(\"Cannot include negative exponent part for integers\");\r\n            text += (new Array(exp + 1)).join(\"0\");\r\n            v = text;\r\n        }\r\n        var isValid = /^([0-9][0-9]*)$/.test(v);\r\n        if (!isValid) throw new Error(\"Invalid integer: \" + v);\r\n        var r = [], max = v.length, l = LOG_BASE, min = max - l;\r\n        while (max > 0) {\r\n            r.push(+v.slice(min, max));\r\n            min -= l;\r\n            if (min < 0) min = 0;\r\n            max -= l;\r\n        }\r\n        trim(r);\r\n        return new BigInteger(r, sign);\r\n    }\r\n\r\n    function parseNumberValue(v) {\r\n        if (isPrecise(v)) {\r\n            if (v !== truncate(v)) throw new Error(v + \" is not an integer.\");\r\n            return new SmallInteger(v);\r\n        }\r\n        return parseStringValue(v.toString());\r\n    }\r\n\r\n    function parseValue(v) {\r\n        if (typeof v === \"number\") {\r\n            return parseNumberValue(v);\r\n        }\r\n        if (typeof v === \"string\") {\r\n            return parseStringValue(v);\r\n        }\r\n        return v;\r\n    }\r\n    // Pre-define numbers in range [-999,999]\r\n    for (var i = 0; i < 1000; i++) {\r\n        Integer[i] = new SmallInteger(i);\r\n        if (i > 0) Integer[-i] = new SmallInteger(-i);\r\n    }\r\n    // Backwards compatibility\r\n    Integer.one = Integer[1];\r\n    Integer.zero = Integer[0];\r\n    Integer.minusOne = Integer[-1];\r\n    Integer.max = max;\r\n    Integer.min = min;\r\n    Integer.gcd = gcd;\r\n    Integer.lcm = lcm;\r\n    Integer.isInstance = function (x) { return x instanceof BigInteger || x instanceof SmallInteger; };\r\n    Integer.randBetween = randBetween;\r\n\r\n    Integer.fromArray = function (digits, base, isNegative) {\r\n        return parseBaseFromArray(digits.map(parseValue), parseValue(base || 10), isNegative);\r\n    };\r\n\r\n    return Integer;\r\n})();\r\n\r\n// Node.js check\r\nif (typeof module !== \"undefined\" && module.hasOwnProperty(\"exports\")) {\r\n    module.exports = bigInt;\r\n}\r\n\r\n//amd check\r\nif (typeof define === \"function\" && define.amd) {\r\n    define(\"big-integer\", [], function () {\r\n        return bigInt;\r\n    });\r\n}\r\n"]},"metadata":{},"sourceType":"script"}