{"ast":null,"code":"// Copyright 2017-2021 @polkadot/util-crypto authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { u8aConcat } from '@polkadot/util';\nimport { naclEncrypt } from \"../nacl/index.js\";\nimport { scryptEncode, scryptToU8a } from \"../scrypt/index.js\";\nimport { jsonEncryptFormat } from \"./encryptFormat.js\";\nexport function jsonEncrypt(data, contentType, passphrase) {\n  let isEncrypted = false;\n  let encoded = data;\n\n  if (passphrase) {\n    const {\n      params,\n      password,\n      salt\n    } = scryptEncode(passphrase);\n    const {\n      encrypted,\n      nonce\n    } = naclEncrypt(encoded, password.subarray(0, 32));\n    isEncrypted = true;\n    encoded = u8aConcat(scryptToU8a(salt, params), nonce, encrypted);\n  }\n\n  return jsonEncryptFormat(encoded, contentType, isEncrypted);\n}","map":{"version":3,"sources":["/home/abubakar/Desktop/KeyStore-Thorchain/node_modules/@polkadot/util-crypto/json/encrypt.js"],"names":["u8aConcat","naclEncrypt","scryptEncode","scryptToU8a","jsonEncryptFormat","jsonEncrypt","data","contentType","passphrase","isEncrypted","encoded","params","password","salt","encrypted","nonce","subarray"],"mappings":"AAAA;AACA;AACA,SAASA,SAAT,QAA0B,gBAA1B;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,SAASC,YAAT,EAAuBC,WAAvB,QAA0C,oBAA1C;AACA,SAASC,iBAAT,QAAkC,oBAAlC;AACA,OAAO,SAASC,WAAT,CAAqBC,IAArB,EAA2BC,WAA3B,EAAwCC,UAAxC,EAAoD;AACzD,MAAIC,WAAW,GAAG,KAAlB;AACA,MAAIC,OAAO,GAAGJ,IAAd;;AAEA,MAAIE,UAAJ,EAAgB;AACd,UAAM;AACJG,MAAAA,MADI;AAEJC,MAAAA,QAFI;AAGJC,MAAAA;AAHI,QAIFX,YAAY,CAACM,UAAD,CAJhB;AAKA,UAAM;AACJM,MAAAA,SADI;AAEJC,MAAAA;AAFI,QAGFd,WAAW,CAACS,OAAD,EAAUE,QAAQ,CAACI,QAAT,CAAkB,CAAlB,EAAqB,EAArB,CAAV,CAHf;AAIAP,IAAAA,WAAW,GAAG,IAAd;AACAC,IAAAA,OAAO,GAAGV,SAAS,CAACG,WAAW,CAACU,IAAD,EAAOF,MAAP,CAAZ,EAA4BI,KAA5B,EAAmCD,SAAnC,CAAnB;AACD;;AAED,SAAOV,iBAAiB,CAACM,OAAD,EAAUH,WAAV,EAAuBE,WAAvB,CAAxB;AACD","sourcesContent":["// Copyright 2017-2021 @polkadot/util-crypto authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { u8aConcat } from '@polkadot/util';\nimport { naclEncrypt } from \"../nacl/index.js\";\nimport { scryptEncode, scryptToU8a } from \"../scrypt/index.js\";\nimport { jsonEncryptFormat } from \"./encryptFormat.js\";\nexport function jsonEncrypt(data, contentType, passphrase) {\n  let isEncrypted = false;\n  let encoded = data;\n\n  if (passphrase) {\n    const {\n      params,\n      password,\n      salt\n    } = scryptEncode(passphrase);\n    const {\n      encrypted,\n      nonce\n    } = naclEncrypt(encoded, password.subarray(0, 32));\n    isEncrypted = true;\n    encoded = u8aConcat(scryptToU8a(salt, params), nonce, encrypted);\n  }\n\n  return jsonEncryptFormat(encoded, contentType, isEncrypted);\n}"]},"metadata":{},"sourceType":"module"}