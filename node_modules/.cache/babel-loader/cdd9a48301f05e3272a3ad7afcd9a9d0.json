{"ast":null,"code":"// Copyright 2017-2021 @polkadot/util-crypto authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { BN_EIGHT, bnToU8a, u8aConcat, u8aToBn } from '@polkadot/util';\nimport { hmacSha512 } from \"../../hmac/index.js\"; // performs hard-only derivation on the xprv\n\nexport function ledgerDerivePrivate(xprv, index) {\n  const kl = xprv.subarray(0, 32);\n  const kr = xprv.subarray(32, 64);\n  const cc = xprv.subarray(64, 96);\n  const data = u8aConcat([0], kl, kr, bnToU8a(index, {\n    bitLength: 32,\n    isLe: true\n  }));\n  const z = hmacSha512(cc, data);\n  data[0] = 0x01;\n  return u8aConcat(bnToU8a(u8aToBn(kl, {\n    isLe: true\n  }).iadd(u8aToBn(z.subarray(0, 28), {\n    isLe: true\n  }).imul(BN_EIGHT)), {\n    bitLength: 512,\n    isLe: true\n  }).subarray(0, 32), bnToU8a(u8aToBn(kr, {\n    isLe: true\n  }).iadd(u8aToBn(z.subarray(32, 64), {\n    isLe: true\n  })), {\n    bitLength: 512,\n    isLe: true\n  }).subarray(0, 32), hmacSha512(cc, data).subarray(32, 64));\n}","map":{"version":3,"sources":["/home/abubakar/Desktop/KeyStore-Thorchain/node_modules/@polkadot/util-crypto/hd/ledger/derivePrivate.js"],"names":["BN_EIGHT","bnToU8a","u8aConcat","u8aToBn","hmacSha512","ledgerDerivePrivate","xprv","index","kl","subarray","kr","cc","data","bitLength","isLe","z","iadd","imul"],"mappings":"AAAA;AACA;AACA,SAASA,QAAT,EAAmBC,OAAnB,EAA4BC,SAA5B,EAAuCC,OAAvC,QAAsD,gBAAtD;AACA,SAASC,UAAT,QAA2B,qBAA3B,C,CAAkD;;AAElD,OAAO,SAASC,mBAAT,CAA6BC,IAA7B,EAAmCC,KAAnC,EAA0C;AAC/C,QAAMC,EAAE,GAAGF,IAAI,CAACG,QAAL,CAAc,CAAd,EAAiB,EAAjB,CAAX;AACA,QAAMC,EAAE,GAAGJ,IAAI,CAACG,QAAL,CAAc,EAAd,EAAkB,EAAlB,CAAX;AACA,QAAME,EAAE,GAAGL,IAAI,CAACG,QAAL,CAAc,EAAd,EAAkB,EAAlB,CAAX;AACA,QAAMG,IAAI,GAAGV,SAAS,CAAC,CAAC,CAAD,CAAD,EAAMM,EAAN,EAAUE,EAAV,EAAcT,OAAO,CAACM,KAAD,EAAQ;AACjDM,IAAAA,SAAS,EAAE,EADsC;AAEjDC,IAAAA,IAAI,EAAE;AAF2C,GAAR,CAArB,CAAtB;AAIA,QAAMC,CAAC,GAAGX,UAAU,CAACO,EAAD,EAAKC,IAAL,CAApB;AACAA,EAAAA,IAAI,CAAC,CAAD,CAAJ,GAAU,IAAV;AACA,SAAOV,SAAS,CAACD,OAAO,CAACE,OAAO,CAACK,EAAD,EAAK;AACnCM,IAAAA,IAAI,EAAE;AAD6B,GAAL,CAAP,CAEtBE,IAFsB,CAEjBb,OAAO,CAACY,CAAC,CAACN,QAAF,CAAW,CAAX,EAAc,EAAd,CAAD,EAAoB;AACjCK,IAAAA,IAAI,EAAE;AAD2B,GAApB,CAAP,CAELG,IAFK,CAEAjB,QAFA,CAFiB,CAAD,EAIJ;AAClBa,IAAAA,SAAS,EAAE,GADO;AAElBC,IAAAA,IAAI,EAAE;AAFY,GAJI,CAAP,CAOdL,QAPc,CAOL,CAPK,EAOF,EAPE,CAAD,EAOIR,OAAO,CAACE,OAAO,CAACO,EAAD,EAAK;AACtCI,IAAAA,IAAI,EAAE;AADgC,GAAL,CAAP,CAEzBE,IAFyB,CAEpBb,OAAO,CAACY,CAAC,CAACN,QAAF,CAAW,EAAX,EAAe,EAAf,CAAD,EAAqB;AAClCK,IAAAA,IAAI,EAAE;AAD4B,GAArB,CAFa,CAAD,EAItB;AACHD,IAAAA,SAAS,EAAE,GADR;AAEHC,IAAAA,IAAI,EAAE;AAFH,GAJsB,CAAP,CAOjBL,QAPiB,CAOR,CAPQ,EAOL,EAPK,CAPJ,EAcIL,UAAU,CAACO,EAAD,EAAKC,IAAL,CAAV,CAAqBH,QAArB,CAA8B,EAA9B,EAAkC,EAAlC,CAdJ,CAAhB;AAeD","sourcesContent":["// Copyright 2017-2021 @polkadot/util-crypto authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { BN_EIGHT, bnToU8a, u8aConcat, u8aToBn } from '@polkadot/util';\nimport { hmacSha512 } from \"../../hmac/index.js\"; // performs hard-only derivation on the xprv\n\nexport function ledgerDerivePrivate(xprv, index) {\n  const kl = xprv.subarray(0, 32);\n  const kr = xprv.subarray(32, 64);\n  const cc = xprv.subarray(64, 96);\n  const data = u8aConcat([0], kl, kr, bnToU8a(index, {\n    bitLength: 32,\n    isLe: true\n  }));\n  const z = hmacSha512(cc, data);\n  data[0] = 0x01;\n  return u8aConcat(bnToU8a(u8aToBn(kl, {\n    isLe: true\n  }).iadd(u8aToBn(z.subarray(0, 28), {\n    isLe: true\n  }).imul(BN_EIGHT)), {\n    bitLength: 512,\n    isLe: true\n  }).subarray(0, 32), bnToU8a(u8aToBn(kr, {\n    isLe: true\n  }).iadd(u8aToBn(z.subarray(32, 64), {\n    isLe: true\n  })), {\n    bitLength: 512,\n    isLe: true\n  }).subarray(0, 32), hmacSha512(cc, data).subarray(32, 64));\n}"]},"metadata":{},"sourceType":"module"}