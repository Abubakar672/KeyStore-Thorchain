{"ast":null,"code":"import { Keyring, ApiPromise, WsProvider } from '@polkadot/api';\nimport { isHex, hexToU8a } from '@polkadot/util';\nimport { Network, singleFee, FeeType, TxType } from '@xchainjs/xchain-client';\nimport { validatePhrase } from '@xchainjs/xchain-crypto';\nimport { Chain, assetToBase, assetAmount, assetToString, baseAmount } from '@xchainjs/xchain-util';\nimport axios from 'axios';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\nfunction __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nfunction __generator(thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n}\n\nvar AssetDOT = {\n  chain: Chain.Polkadot,\n  symbol: 'DOT',\n  ticker: 'DOT'\n};\n/**\r\n * Check Subscan API response\r\n *\r\n * @param {SubscanResponse} response The subscan response.\r\n * @returns {boolean} `true` or `false`\r\n */\n\nvar isSuccess = function (response) {\n  return !response.code;\n};\n/**\r\n * Get the decimal based on the network\r\n *\r\n * @param {Network} network The network.\r\n * @returns {number} The decimal based on the network.\r\n */\n\n\nvar getDecimal = function (network) {\n  switch (network) {\n    case Network.Mainnet:\n      return 10;\n\n    case Network.Testnet:\n      return 12;\n  }\n};\n/**\r\n * Get the default fees.\r\n *\r\n * @returns {Fees} The default fees based on the network.\r\n */\n\n\nvar getDefaultFees = function (network) {\n  var fee = assetToBase(assetAmount(0.015, getDecimal(network)));\n  return singleFee(FeeType.PerByte, fee);\n};\n/**\r\n * Get address prefix based on the network.\r\n *\r\n * @param {Network} network\r\n * @returns {string} The address prefix based on the network.\r\n *\r\n **/\n\n\nvar getPrefix = function (network) {\n  switch (network) {\n    case Network.Mainnet:\n      return '1';\n\n    case Network.Testnet:\n      return '5';\n  }\n};\n/**\r\n * Custom Polkadot client\r\n */\n\n\nvar Client =\n/** @class */\nfunction () {\n  /**\r\n   * Constructor\r\n   * Client is initialised with network type and phrase (optional)\r\n   *\r\n   * @param {XChainClientParams} params\r\n   */\n  function Client(_a) {\n    var _b;\n\n    var _c = _a.network,\n        network = _c === void 0 ? Network.Testnet : _c,\n        phrase = _a.phrase,\n        _d = _a.rootDerivationPaths,\n        rootDerivationPaths = _d === void 0 ? (_b = {}, _b[Network.Mainnet] = \"44//354//0//0//0'\", _b[Network.Testnet] = \"44//354//0//0//0'\", _b) : _d;\n    this.phrase = '';\n    this.network = network;\n    this.rootDerivationPaths = rootDerivationPaths;\n    if (phrase) this.setPhrase(phrase);\n  }\n  /**\r\n   * Get getFullDerivationPath\r\n   *\r\n   * @param {number} index the HD wallet index\r\n   * @returns {string} The polkadot derivation path based on the network.\r\n   */\n\n\n  Client.prototype.getFullDerivationPath = function (index) {\n    if (index === void 0) {\n      index = 0;\n    } // console.log(this.rootDerivationPaths[this.network])\n\n\n    if (index === 0) {\n      // this should make the tests backwards compatible\n      return this.rootDerivationPaths[this.network];\n    } else {\n      return this.rootDerivationPaths[this.network] + (\"//\" + index);\n    }\n  };\n  /**\r\n   * Purge client.\r\n   *\r\n   * @returns {void}\r\n   */\n\n\n  Client.prototype.purgeClient = function () {\n    this.phrase = '';\n  };\n  /**\r\n   * Set/update the current network.\r\n   *\r\n   * @param {Network} network\r\n   *\r\n   * @throws {\"Network must be provided\"}\r\n   * Thrown if network has not been set before.\r\n   */\n\n\n  Client.prototype.setNetwork = function (network) {\n    if (!network) {\n      throw new Error('Network must be provided');\n    } else {\n      if (network !== this.network) {\n        this.network = network;\n      }\n    }\n  };\n  /**\r\n   * Get the current network.\r\n   *\r\n   * @returns {Network}\r\n   */\n\n\n  Client.prototype.getNetwork = function () {\n    return this.network;\n  };\n  /**\r\n   * Get the client url.\r\n   *\r\n   * @returns {string} The client url based on the network.\r\n   */\n\n\n  Client.prototype.getClientUrl = function () {\n    switch (this.network) {\n      case Network.Mainnet:\n        return 'https://polkadot.subscan.io';\n\n      case Network.Testnet:\n        return 'https://westend.subscan.io';\n    }\n  };\n  /**\r\n   * Get the client WebSocket url.\r\n   *\r\n   * @returns {string} The client WebSocket url based on the network.\r\n   */\n\n\n  Client.prototype.getWsEndpoint = function () {\n    switch (this.network) {\n      case Network.Mainnet:\n        return 'wss://rpc.polkadot.io';\n\n      case Network.Testnet:\n        return 'wss://westend-rpc.polkadot.io';\n    }\n  };\n  /**\r\n   * Get the explorer url.\r\n   *\r\n   * @returns {string} The explorer url based on the network.\r\n   */\n\n\n  Client.prototype.getExplorerUrl = function () {\n    switch (this.network) {\n      case Network.Mainnet:\n        return 'https://polkadot.subscan.io';\n\n      case Network.Testnet:\n        return 'https://westend.subscan.io';\n    }\n  };\n  /**\r\n   * Get the explorer url for the given address.\r\n   *\r\n   * @param {Address} address\r\n   * @returns {string} The explorer url for the given address based on the network.\r\n   */\n\n\n  Client.prototype.getExplorerAddressUrl = function (address) {\n    return this.getExplorerUrl() + \"/account/\" + address;\n  };\n  /**\r\n   * Get the explorer url for the given transaction id.\r\n   *\r\n   * @param {string} txID The transaction id\r\n   * @returns {string} The explorer url for the given transaction id based on the network.\r\n   */\n\n\n  Client.prototype.getExplorerTxUrl = function (txID) {\n    return this.getExplorerUrl() + \"/extrinsic/\" + txID;\n  };\n  /**\r\n   * Get the SS58 format to be used for Polkadot Keyring.\r\n   *\r\n   * @returns {number} The SS58 format based on the network.\r\n   */\n\n\n  Client.prototype.getSS58Format = function () {\n    switch (this.network) {\n      case Network.Mainnet:\n        return 0;\n\n      case Network.Testnet:\n        return 42;\n    }\n  };\n  /**\r\n   * Set/update a new phrase.\r\n   *\r\n   * @param {string} phrase A new phrase.\r\n   * @returns {Address} The address from the given phrase\r\n   *\r\n   * @throws {\"Invalid phrase\"}\r\n   * Thrown if the given phase is invalid.\r\n   */\n\n\n  Client.prototype.setPhrase = function (phrase, walletIndex) {\n    if (walletIndex === void 0) {\n      walletIndex = 0;\n    }\n\n    if (this.phrase !== phrase) {\n      if (!validatePhrase(phrase)) {\n        throw new Error('Invalid phrase');\n      }\n\n      this.phrase = phrase;\n    }\n\n    return this.getAddress(walletIndex);\n  };\n  /**\r\n   * @private\r\n   * Private function to get Keyring pair for polkadotjs provider.\r\n   * @see https://polkadot.js.org/docs/api/start/keyring/#creating-a-keyring-instance\r\n   *\r\n   * @returns {KeyringPair} The keyring pair to be used to generate wallet address.\r\n   * */\n\n\n  Client.prototype.getKeyringPair = function (index) {\n    var key = new Keyring({\n      ss58Format: this.getSS58Format(),\n      type: 'ed25519'\n    });\n    return key.createFromUri(this.phrase + \"//\" + this.getFullDerivationPath(index));\n  };\n  /**\r\n   * @private\r\n   * Private function to get the polkadotjs API provider.\r\n   *\r\n   * @see https://polkadot.js.org/docs/api/start/create#api-instance\r\n   *\r\n   * @returns {ApiPromise} The polkadotjs API provider based on the network.\r\n   * */\n\n\n  Client.prototype.getAPI = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var api;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            api = new ApiPromise({\n              provider: new WsProvider(this.getWsEndpoint())\n            });\n            return [4\n            /*yield*/\n            , api.isReady];\n\n          case 1:\n            _a.sent();\n\n            if (!!api.isConnected) return [3\n            /*break*/\n            , 3];\n            return [4\n            /*yield*/\n            , api.connect()];\n\n          case 2:\n            _a.sent();\n\n            _a.label = 3;\n\n          case 3:\n            return [2\n            /*return*/\n            , api];\n        }\n      });\n    });\n  };\n  /**\r\n   * Validate the given address.\r\n   * @see https://polkadot.js.org/docs/util-crypto/examples/validate-address\r\n   *\r\n   * @param {Address} address\r\n   * @returns {boolean} `true` or `false`\r\n   */\n\n\n  Client.prototype.validateAddress = function (address) {\n    try {\n      var key = new Keyring({\n        ss58Format: this.getSS58Format(),\n        type: 'ed25519'\n      });\n      return key.encodeAddress(isHex(address) ? hexToU8a(address) : key.decodeAddress(address)) === address;\n    } catch (error) {\n      return false;\n    }\n  };\n  /**\r\n   * Get the current address.\r\n   *\r\n   * Generates a network-specific key-pair by first converting the buffer to a Wallet-Import-Format (WIF)\r\n   * The address is then decoded into type P2WPKH and returned.\r\n   *\r\n   * @returns {Address} The current address.\r\n   *\r\n   * @throws {\"Address not defined\"} Thrown if failed creating account from phrase.\r\n   */\n\n\n  Client.prototype.getAddress = function (index) {\n    if (index === void 0) {\n      index = 0;\n    }\n\n    return this.getKeyringPair(index).address;\n  };\n  /**\r\n   * Get the DOT balance of a given address.\r\n   *\r\n   * @param {Address} address By default, it will return the balance of the current wallet. (optional)\r\n   * @returns {Balance[]} The DOT balance of the address.\r\n   */\n\n\n  Client.prototype.getBalance = function (address, assets) {\n    return __awaiter(this, void 0, void 0, function () {\n      var response, account;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , axios.post(this.getClientUrl() + \"/api/open/account\", {\n              address: address || this.getAddress()\n            })];\n\n          case 1:\n            response = _a.sent().data;\n            if (!isSuccess(response)) throw new Error('Invalid address');\n            account = response.data;\n            return [2\n            /*return*/\n            , account && (!assets || assets.filter(function (asset) {\n              return assetToString(AssetDOT) === assetToString(asset);\n            }).length) ? [{\n              asset: AssetDOT,\n              amount: assetToBase(assetAmount(account.balance, getDecimal(this.network)))\n            }] : []];\n        }\n      });\n    });\n  };\n  /**\r\n   * Get transaction history of a given address with pagination options.\r\n   * By default it will return the transaction history of the current wallet.\r\n   *\r\n   * @param {TxHistoryParams} params The options to get transaction history. (optional)\r\n   * @returns {TxsPage} The transaction history.\r\n   */\n\n\n  Client.prototype.getTransactions = function (params) {\n    var _a, _b;\n\n    return __awaiter(this, void 0, void 0, function () {\n      var limit, offset, response, transferResult;\n\n      var _this = this;\n\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            limit = (_a = params === null || params === void 0 ? void 0 : params.limit) !== null && _a !== void 0 ? _a : 10;\n            offset = (_b = params === null || params === void 0 ? void 0 : params.offset) !== null && _b !== void 0 ? _b : 0;\n            return [4\n            /*yield*/\n            , axios.post(this.getClientUrl() + \"/api/scan/transfers\", {\n              address: params === null || params === void 0 ? void 0 : params.address,\n              row: limit,\n              page: offset\n            })];\n\n          case 1:\n            response = _c.sent().data;\n            if (!isSuccess(response) || !response.data) throw new Error('Failed to get transactions');\n            transferResult = response.data;\n            return [2\n            /*return*/\n            , {\n              total: transferResult.count,\n              txs: (transferResult.transfers || []).map(function (transfer) {\n                return {\n                  asset: AssetDOT,\n                  from: [{\n                    from: transfer.from,\n                    amount: assetToBase(assetAmount(transfer.amount, getDecimal(_this.network)))\n                  }],\n                  to: [{\n                    to: transfer.to,\n                    amount: assetToBase(assetAmount(transfer.amount, getDecimal(_this.network)))\n                  }],\n                  date: new Date(transfer.block_timestamp * 1000),\n                  type: TxType.Transfer,\n                  hash: transfer.hash\n                };\n              })\n            }];\n        }\n      });\n    });\n  };\n  /**\r\n   * Get the transaction details of a given transaction id.\r\n   *\r\n   * @param {string} txId The transaction id.\r\n   * @returns {Tx} The transaction details of the given transaction id.\r\n   */\n\n\n  Client.prototype.getTransactionData = function (txId) {\n    return __awaiter(this, void 0, void 0, function () {\n      var response, extrinsic, transfer;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , axios.post(this.getClientUrl() + \"/api/scan/extrinsic\", {\n              hash: txId\n            })];\n\n          case 1:\n            response = _a.sent().data;\n            if (!isSuccess(response) || !response.data) throw new Error('Failed to get transactions');\n            extrinsic = response.data;\n            transfer = extrinsic.transfer;\n            return [2\n            /*return*/\n            , {\n              asset: AssetDOT,\n              from: [{\n                from: transfer.from,\n                amount: assetToBase(assetAmount(transfer.amount, getDecimal(this.network)))\n              }],\n              to: [{\n                to: transfer.to,\n                amount: assetToBase(assetAmount(transfer.amount, getDecimal(this.network)))\n              }],\n              date: new Date(extrinsic.block_timestamp * 1000),\n              type: TxType.Transfer,\n              hash: extrinsic.extrinsic_hash\n            }];\n        }\n      });\n    });\n  };\n  /**\r\n   * Transfer DOT.\r\n   *\r\n   * @param {TxParams} params The transfer options.\r\n   * @returns {TxHash} The transaction hash.\r\n   */\n\n\n  Client.prototype.transfer = function (params) {\n    return __awaiter(this, void 0, void 0, function () {\n      var api, transaction, walletIndex, transfer, remark, paymentInfo, fee, balances, txHash;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.getAPI()];\n\n          case 1:\n            api = _a.sent();\n            transaction = null;\n            walletIndex = params.walletIndex || 0;\n            transfer = api.tx.balances.transfer(params.recipient, params.amount.amount().toString());\n\n            if (!params.memo) {\n              // Send a simple transfer\n              transaction = transfer;\n            } else {\n              remark = api.tx.system.remark(params.memo); // Send the Batch Transaction\n\n              transaction = api.tx.utility.batch([transfer, remark]);\n            }\n\n            return [4\n            /*yield*/\n            , transaction.paymentInfo(this.getKeyringPair(walletIndex))];\n\n          case 2:\n            paymentInfo = _a.sent();\n            fee = baseAmount(paymentInfo.partialFee.toString(), getDecimal(this.network));\n            return [4\n            /*yield*/\n            , this.getBalance(this.getAddress(walletIndex), [AssetDOT])];\n\n          case 3:\n            balances = _a.sent();\n\n            if (!balances || params.amount.amount().plus(fee.amount()).isGreaterThan(balances[0].amount.amount())) {\n              throw new Error('insufficient balance');\n            }\n\n            return [4\n            /*yield*/\n            , transaction.signAndSend(this.getKeyringPair(walletIndex))];\n\n          case 4:\n            txHash = _a.sent();\n            return [4\n            /*yield*/\n            , api.disconnect()];\n\n          case 5:\n            _a.sent();\n\n            return [2\n            /*return*/\n            , txHash.toString()];\n        }\n      });\n    });\n  };\n  /**\r\n   * Get the current fee with transfer options.\r\n   *\r\n   * @see https://polkadot.js.org/docs/api/cookbook/tx/#how-do-i-estimate-the-transaction-fees\r\n   *\r\n   * @param {TxParams} params The transfer options.\r\n   * @returns {Fees} The estimated fees with the transfer options.\r\n   */\n\n\n  Client.prototype.estimateFees = function (params) {\n    return __awaiter(this, void 0, void 0, function () {\n      var walletIndex, api, info, fee;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            walletIndex = params.walletIndex ? params.walletIndex : 0;\n            return [4\n            /*yield*/\n            , this.getAPI()];\n\n          case 1:\n            api = _a.sent();\n            return [4\n            /*yield*/\n            , api.tx.balances.transfer(params.recipient, params.amount.amount().toNumber()).paymentInfo(this.getKeyringPair(walletIndex))];\n\n          case 2:\n            info = _a.sent();\n            fee = baseAmount(info.partialFee.toString(), getDecimal(this.network));\n            return [4\n            /*yield*/\n            , api.disconnect()];\n\n          case 3:\n            _a.sent();\n\n            return [2\n            /*return*/\n            , singleFee(FeeType.PerByte, fee)];\n        }\n      });\n    });\n  };\n  /**\r\n   * Get the current fee.\r\n   *\r\n   * @returns {Fees} The current fee.\r\n   */\n\n\n  Client.prototype.getFees = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.estimateFees({\n              recipient: this.getAddress(),\n              amount: baseAmount(0, getDecimal(this.network))\n            })];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n        }\n      });\n    });\n  };\n\n  return Client;\n}();\n\nexport { AssetDOT, Client, getDecimal, getDefaultFees, getPrefix, isSuccess };","map":{"version":3,"sources":["/home/abubakar/Desktop/KeyStore-Thorchain/node_modules/@xchainjs/xchain-polkadot/lib/index.esm.js"],"names":["Keyring","ApiPromise","WsProvider","isHex","hexToU8a","Network","singleFee","FeeType","TxType","validatePhrase","Chain","assetToBase","assetAmount","assetToString","baseAmount","axios","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","AssetDOT","chain","Polkadot","symbol","ticker","isSuccess","response","code","getDecimal","network","Mainnet","Testnet","getDefaultFees","fee","PerByte","getPrefix","Client","_a","_b","_c","phrase","_d","rootDerivationPaths","setPhrase","prototype","getFullDerivationPath","index","purgeClient","setNetwork","Error","getNetwork","getClientUrl","getWsEndpoint","getExplorerUrl","getExplorerAddressUrl","address","getExplorerTxUrl","txID","getSS58Format","walletIndex","getAddress","getKeyringPair","key","ss58Format","type","createFromUri","getAPI","api","provider","isReady","isConnected","connect","validateAddress","encodeAddress","decodeAddress","error","getBalance","assets","account","post","data","filter","asset","amount","balance","getTransactions","params","limit","offset","transferResult","_this","row","page","total","count","txs","transfers","map","transfer","from","to","date","Date","block_timestamp","Transfer","hash","getTransactionData","txId","extrinsic","extrinsic_hash","transaction","remark","paymentInfo","balances","txHash","tx","recipient","toString","memo","system","utility","batch","partialFee","plus","isGreaterThan","signAndSend","disconnect","estimateFees","info","toNumber","getFees"],"mappings":"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","sourcesContent":["import { Keyring, ApiPromise, WsProvider } from '@polkadot/api';\nimport { isHex, hexToU8a } from '@polkadot/util';\nimport { Network, singleFee, FeeType, TxType } from '@xchainjs/xchain-client';\nimport { validatePhrase } from '@xchainjs/xchain-crypto';\nimport { Chain, assetToBase, assetAmount, assetToString, baseAmount } from '@xchainjs/xchain-util';\nimport axios from 'axios';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\n\nvar AssetDOT = { chain: Chain.Polkadot, symbol: 'DOT', ticker: 'DOT' };\n\n/**\r\n * Check Subscan API response\r\n *\r\n * @param {SubscanResponse} response The subscan response.\r\n * @returns {boolean} `true` or `false`\r\n */\r\nvar isSuccess = function (response) { return !response.code; };\r\n/**\r\n * Get the decimal based on the network\r\n *\r\n * @param {Network} network The network.\r\n * @returns {number} The decimal based on the network.\r\n */\r\nvar getDecimal = function (network) {\r\n    switch (network) {\r\n        case Network.Mainnet:\r\n            return 10;\r\n        case Network.Testnet:\r\n            return 12;\r\n    }\r\n};\r\n/**\r\n * Get the default fees.\r\n *\r\n * @returns {Fees} The default fees based on the network.\r\n */\r\nvar getDefaultFees = function (network) {\r\n    var fee = assetToBase(assetAmount(0.015, getDecimal(network)));\r\n    return singleFee(FeeType.PerByte, fee);\r\n};\r\n/**\r\n * Get address prefix based on the network.\r\n *\r\n * @param {Network} network\r\n * @returns {string} The address prefix based on the network.\r\n *\r\n **/\r\nvar getPrefix = function (network) {\r\n    switch (network) {\r\n        case Network.Mainnet:\r\n            return '1';\r\n        case Network.Testnet:\r\n            return '5';\r\n    }\r\n};\n\n/**\r\n * Custom Polkadot client\r\n */\r\nvar Client = /** @class */ (function () {\r\n    /**\r\n     * Constructor\r\n     * Client is initialised with network type and phrase (optional)\r\n     *\r\n     * @param {XChainClientParams} params\r\n     */\r\n    function Client(_a) {\r\n        var _b;\r\n        var _c = _a.network, network = _c === void 0 ? Network.Testnet : _c, phrase = _a.phrase, _d = _a.rootDerivationPaths, rootDerivationPaths = _d === void 0 ? (_b = {},\r\n            _b[Network.Mainnet] = \"44//354//0//0//0'\",\r\n            _b[Network.Testnet] = \"44//354//0//0//0'\",\r\n            _b) : _d;\r\n        this.phrase = '';\r\n        this.network = network;\r\n        this.rootDerivationPaths = rootDerivationPaths;\r\n        if (phrase)\r\n            this.setPhrase(phrase);\r\n    }\r\n    /**\r\n     * Get getFullDerivationPath\r\n     *\r\n     * @param {number} index the HD wallet index\r\n     * @returns {string} The polkadot derivation path based on the network.\r\n     */\r\n    Client.prototype.getFullDerivationPath = function (index) {\r\n        if (index === void 0) { index = 0; }\r\n        // console.log(this.rootDerivationPaths[this.network])\r\n        if (index === 0) {\r\n            // this should make the tests backwards compatible\r\n            return this.rootDerivationPaths[this.network];\r\n        }\r\n        else {\r\n            return this.rootDerivationPaths[this.network] + (\"//\" + index);\r\n        }\r\n    };\r\n    /**\r\n     * Purge client.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    Client.prototype.purgeClient = function () {\r\n        this.phrase = '';\r\n    };\r\n    /**\r\n     * Set/update the current network.\r\n     *\r\n     * @param {Network} network\r\n     *\r\n     * @throws {\"Network must be provided\"}\r\n     * Thrown if network has not been set before.\r\n     */\r\n    Client.prototype.setNetwork = function (network) {\r\n        if (!network) {\r\n            throw new Error('Network must be provided');\r\n        }\r\n        else {\r\n            if (network !== this.network) {\r\n                this.network = network;\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Get the current network.\r\n     *\r\n     * @returns {Network}\r\n     */\r\n    Client.prototype.getNetwork = function () {\r\n        return this.network;\r\n    };\r\n    /**\r\n     * Get the client url.\r\n     *\r\n     * @returns {string} The client url based on the network.\r\n     */\r\n    Client.prototype.getClientUrl = function () {\r\n        switch (this.network) {\r\n            case Network.Mainnet:\r\n                return 'https://polkadot.subscan.io';\r\n            case Network.Testnet:\r\n                return 'https://westend.subscan.io';\r\n        }\r\n    };\r\n    /**\r\n     * Get the client WebSocket url.\r\n     *\r\n     * @returns {string} The client WebSocket url based on the network.\r\n     */\r\n    Client.prototype.getWsEndpoint = function () {\r\n        switch (this.network) {\r\n            case Network.Mainnet:\r\n                return 'wss://rpc.polkadot.io';\r\n            case Network.Testnet:\r\n                return 'wss://westend-rpc.polkadot.io';\r\n        }\r\n    };\r\n    /**\r\n     * Get the explorer url.\r\n     *\r\n     * @returns {string} The explorer url based on the network.\r\n     */\r\n    Client.prototype.getExplorerUrl = function () {\r\n        switch (this.network) {\r\n            case Network.Mainnet:\r\n                return 'https://polkadot.subscan.io';\r\n            case Network.Testnet:\r\n                return 'https://westend.subscan.io';\r\n        }\r\n    };\r\n    /**\r\n     * Get the explorer url for the given address.\r\n     *\r\n     * @param {Address} address\r\n     * @returns {string} The explorer url for the given address based on the network.\r\n     */\r\n    Client.prototype.getExplorerAddressUrl = function (address) {\r\n        return this.getExplorerUrl() + \"/account/\" + address;\r\n    };\r\n    /**\r\n     * Get the explorer url for the given transaction id.\r\n     *\r\n     * @param {string} txID The transaction id\r\n     * @returns {string} The explorer url for the given transaction id based on the network.\r\n     */\r\n    Client.prototype.getExplorerTxUrl = function (txID) {\r\n        return this.getExplorerUrl() + \"/extrinsic/\" + txID;\r\n    };\r\n    /**\r\n     * Get the SS58 format to be used for Polkadot Keyring.\r\n     *\r\n     * @returns {number} The SS58 format based on the network.\r\n     */\r\n    Client.prototype.getSS58Format = function () {\r\n        switch (this.network) {\r\n            case Network.Mainnet:\r\n                return 0;\r\n            case Network.Testnet:\r\n                return 42;\r\n        }\r\n    };\r\n    /**\r\n     * Set/update a new phrase.\r\n     *\r\n     * @param {string} phrase A new phrase.\r\n     * @returns {Address} The address from the given phrase\r\n     *\r\n     * @throws {\"Invalid phrase\"}\r\n     * Thrown if the given phase is invalid.\r\n     */\r\n    Client.prototype.setPhrase = function (phrase, walletIndex) {\r\n        if (walletIndex === void 0) { walletIndex = 0; }\r\n        if (this.phrase !== phrase) {\r\n            if (!validatePhrase(phrase)) {\r\n                throw new Error('Invalid phrase');\r\n            }\r\n            this.phrase = phrase;\r\n        }\r\n        return this.getAddress(walletIndex);\r\n    };\r\n    /**\r\n     * @private\r\n     * Private function to get Keyring pair for polkadotjs provider.\r\n     * @see https://polkadot.js.org/docs/api/start/keyring/#creating-a-keyring-instance\r\n     *\r\n     * @returns {KeyringPair} The keyring pair to be used to generate wallet address.\r\n     * */\r\n    Client.prototype.getKeyringPair = function (index) {\r\n        var key = new Keyring({ ss58Format: this.getSS58Format(), type: 'ed25519' });\r\n        return key.createFromUri(this.phrase + \"//\" + this.getFullDerivationPath(index));\r\n    };\r\n    /**\r\n     * @private\r\n     * Private function to get the polkadotjs API provider.\r\n     *\r\n     * @see https://polkadot.js.org/docs/api/start/create#api-instance\r\n     *\r\n     * @returns {ApiPromise} The polkadotjs API provider based on the network.\r\n     * */\r\n    Client.prototype.getAPI = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var api;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        api = new ApiPromise({ provider: new WsProvider(this.getWsEndpoint()) });\r\n                        return [4 /*yield*/, api.isReady];\r\n                    case 1:\r\n                        _a.sent();\r\n                        if (!!api.isConnected) return [3 /*break*/, 3];\r\n                        return [4 /*yield*/, api.connect()];\r\n                    case 2:\r\n                        _a.sent();\r\n                        _a.label = 3;\r\n                    case 3: return [2 /*return*/, api];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Validate the given address.\r\n     * @see https://polkadot.js.org/docs/util-crypto/examples/validate-address\r\n     *\r\n     * @param {Address} address\r\n     * @returns {boolean} `true` or `false`\r\n     */\r\n    Client.prototype.validateAddress = function (address) {\r\n        try {\r\n            var key = new Keyring({ ss58Format: this.getSS58Format(), type: 'ed25519' });\r\n            return key.encodeAddress(isHex(address) ? hexToU8a(address) : key.decodeAddress(address)) === address;\r\n        }\r\n        catch (error) {\r\n            return false;\r\n        }\r\n    };\r\n    /**\r\n     * Get the current address.\r\n     *\r\n     * Generates a network-specific key-pair by first converting the buffer to a Wallet-Import-Format (WIF)\r\n     * The address is then decoded into type P2WPKH and returned.\r\n     *\r\n     * @returns {Address} The current address.\r\n     *\r\n     * @throws {\"Address not defined\"} Thrown if failed creating account from phrase.\r\n     */\r\n    Client.prototype.getAddress = function (index) {\r\n        if (index === void 0) { index = 0; }\r\n        return this.getKeyringPair(index).address;\r\n    };\r\n    /**\r\n     * Get the DOT balance of a given address.\r\n     *\r\n     * @param {Address} address By default, it will return the balance of the current wallet. (optional)\r\n     * @returns {Balance[]} The DOT balance of the address.\r\n     */\r\n    Client.prototype.getBalance = function (address, assets) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var response, account;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, axios.post(this.getClientUrl() + \"/api/open/account\", { address: address || this.getAddress() })];\r\n                    case 1:\r\n                        response = (_a.sent()).data;\r\n                        if (!isSuccess(response))\r\n                            throw new Error('Invalid address');\r\n                        account = response.data;\r\n                        return [2 /*return*/, account && (!assets || assets.filter(function (asset) { return assetToString(AssetDOT) === assetToString(asset); }).length)\r\n                                ? [\r\n                                    {\r\n                                        asset: AssetDOT,\r\n                                        amount: assetToBase(assetAmount(account.balance, getDecimal(this.network))),\r\n                                    },\r\n                                ]\r\n                                : []];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Get transaction history of a given address with pagination options.\r\n     * By default it will return the transaction history of the current wallet.\r\n     *\r\n     * @param {TxHistoryParams} params The options to get transaction history. (optional)\r\n     * @returns {TxsPage} The transaction history.\r\n     */\r\n    Client.prototype.getTransactions = function (params) {\r\n        var _a, _b;\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var limit, offset, response, transferResult;\r\n            var _this = this;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        limit = (_a = params === null || params === void 0 ? void 0 : params.limit) !== null && _a !== void 0 ? _a : 10;\r\n                        offset = (_b = params === null || params === void 0 ? void 0 : params.offset) !== null && _b !== void 0 ? _b : 0;\r\n                        return [4 /*yield*/, axios.post(this.getClientUrl() + \"/api/scan/transfers\", {\r\n                                address: params === null || params === void 0 ? void 0 : params.address,\r\n                                row: limit,\r\n                                page: offset,\r\n                            })];\r\n                    case 1:\r\n                        response = (_c.sent()).data;\r\n                        if (!isSuccess(response) || !response.data)\r\n                            throw new Error('Failed to get transactions');\r\n                        transferResult = response.data;\r\n                        return [2 /*return*/, {\r\n                                total: transferResult.count,\r\n                                txs: (transferResult.transfers || []).map(function (transfer) { return ({\r\n                                    asset: AssetDOT,\r\n                                    from: [\r\n                                        {\r\n                                            from: transfer.from,\r\n                                            amount: assetToBase(assetAmount(transfer.amount, getDecimal(_this.network))),\r\n                                        },\r\n                                    ],\r\n                                    to: [\r\n                                        {\r\n                                            to: transfer.to,\r\n                                            amount: assetToBase(assetAmount(transfer.amount, getDecimal(_this.network))),\r\n                                        },\r\n                                    ],\r\n                                    date: new Date(transfer.block_timestamp * 1000),\r\n                                    type: TxType.Transfer,\r\n                                    hash: transfer.hash,\r\n                                }); }),\r\n                            }];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Get the transaction details of a given transaction id.\r\n     *\r\n     * @param {string} txId The transaction id.\r\n     * @returns {Tx} The transaction details of the given transaction id.\r\n     */\r\n    Client.prototype.getTransactionData = function (txId) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var response, extrinsic, transfer;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, axios.post(this.getClientUrl() + \"/api/scan/extrinsic\", { hash: txId })];\r\n                    case 1:\r\n                        response = (_a.sent()).data;\r\n                        if (!isSuccess(response) || !response.data)\r\n                            throw new Error('Failed to get transactions');\r\n                        extrinsic = response.data;\r\n                        transfer = extrinsic.transfer;\r\n                        return [2 /*return*/, {\r\n                                asset: AssetDOT,\r\n                                from: [\r\n                                    {\r\n                                        from: transfer.from,\r\n                                        amount: assetToBase(assetAmount(transfer.amount, getDecimal(this.network))),\r\n                                    },\r\n                                ],\r\n                                to: [\r\n                                    {\r\n                                        to: transfer.to,\r\n                                        amount: assetToBase(assetAmount(transfer.amount, getDecimal(this.network))),\r\n                                    },\r\n                                ],\r\n                                date: new Date(extrinsic.block_timestamp * 1000),\r\n                                type: TxType.Transfer,\r\n                                hash: extrinsic.extrinsic_hash,\r\n                            }];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Transfer DOT.\r\n     *\r\n     * @param {TxParams} params The transfer options.\r\n     * @returns {TxHash} The transaction hash.\r\n     */\r\n    Client.prototype.transfer = function (params) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var api, transaction, walletIndex, transfer, remark, paymentInfo, fee, balances, txHash;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.getAPI()];\r\n                    case 1:\r\n                        api = _a.sent();\r\n                        transaction = null;\r\n                        walletIndex = params.walletIndex || 0;\r\n                        transfer = api.tx.balances.transfer(params.recipient, params.amount.amount().toString());\r\n                        if (!params.memo) {\r\n                            // Send a simple transfer\r\n                            transaction = transfer;\r\n                        }\r\n                        else {\r\n                            remark = api.tx.system.remark(params.memo);\r\n                            // Send the Batch Transaction\r\n                            transaction = api.tx.utility.batch([transfer, remark]);\r\n                        }\r\n                        return [4 /*yield*/, transaction.paymentInfo(this.getKeyringPair(walletIndex))];\r\n                    case 2:\r\n                        paymentInfo = _a.sent();\r\n                        fee = baseAmount(paymentInfo.partialFee.toString(), getDecimal(this.network));\r\n                        return [4 /*yield*/, this.getBalance(this.getAddress(walletIndex), [AssetDOT])];\r\n                    case 3:\r\n                        balances = _a.sent();\r\n                        if (!balances || params.amount.amount().plus(fee.amount()).isGreaterThan(balances[0].amount.amount())) {\r\n                            throw new Error('insufficient balance');\r\n                        }\r\n                        return [4 /*yield*/, transaction.signAndSend(this.getKeyringPair(walletIndex))];\r\n                    case 4:\r\n                        txHash = _a.sent();\r\n                        return [4 /*yield*/, api.disconnect()];\r\n                    case 5:\r\n                        _a.sent();\r\n                        return [2 /*return*/, txHash.toString()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Get the current fee with transfer options.\r\n     *\r\n     * @see https://polkadot.js.org/docs/api/cookbook/tx/#how-do-i-estimate-the-transaction-fees\r\n     *\r\n     * @param {TxParams} params The transfer options.\r\n     * @returns {Fees} The estimated fees with the transfer options.\r\n     */\r\n    Client.prototype.estimateFees = function (params) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var walletIndex, api, info, fee;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        walletIndex = params.walletIndex ? params.walletIndex : 0;\r\n                        return [4 /*yield*/, this.getAPI()];\r\n                    case 1:\r\n                        api = _a.sent();\r\n                        return [4 /*yield*/, api.tx.balances\r\n                                .transfer(params.recipient, params.amount.amount().toNumber())\r\n                                .paymentInfo(this.getKeyringPair(walletIndex))];\r\n                    case 2:\r\n                        info = _a.sent();\r\n                        fee = baseAmount(info.partialFee.toString(), getDecimal(this.network));\r\n                        return [4 /*yield*/, api.disconnect()];\r\n                    case 3:\r\n                        _a.sent();\r\n                        return [2 /*return*/, singleFee(FeeType.PerByte, fee)];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Get the current fee.\r\n     *\r\n     * @returns {Fees} The current fee.\r\n     */\r\n    Client.prototype.getFees = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.estimateFees({\r\n                            recipient: this.getAddress(),\r\n                            amount: baseAmount(0, getDecimal(this.network)),\r\n                        })];\r\n                    case 1: return [2 /*return*/, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return Client;\r\n}());\n\nexport { AssetDOT, Client, getDecimal, getDefaultFees, getPrefix, isSuccess };\n"]},"metadata":{},"sourceType":"module"}